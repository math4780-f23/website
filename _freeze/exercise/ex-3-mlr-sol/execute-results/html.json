{
  "hash": "37167bedd6d726a444134bb4a344df43",
  "result": {
    "markdown": "---\ntitle: \"Exercise 3: Multiple Linear Regression Solution\"\neditor: source\nreference-location: margin\n---\n\n\n::: callout-note\nExercises are for practice purpose only.\n:::\n\n\n## Multiple Linear Regression\n\n<!-- ISL 3.15 -->\n1. This problem involves the `Boston` data set. We now try to predict per capita crime rate using the other variables in this data set. In other words, per capita crime rate is the response, and the other variables are the predictors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ISLR2)\n```\n:::\n\n\na. For each predictor, fit a simple linear regression model to predict the response. Describe your results. In which of the models is there a statistically significant association between the predictor and the response? Create some plots to back up your assertions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npval <- coef_slr <- rep(0, 12)\nnames(pval) <- names(coef_slr) <- names(Boston[-1])\nfor (i in 1:12) {\n  slr <- lm(Boston$crim ~ Boston[[i+1]])\n  summ <- summary(slr)\n  pp <- \n  coef_slr[i] <- summ$coefficients[2, 1]\n  pval[i] <- summ$coefficients[2, 4]\n}\n\npval[pval < 0.05]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          zn        indus          nox           rm          age          dis \n5.506472e-06 1.450349e-21 3.751739e-23 6.346703e-07 2.854869e-16 8.519949e-19 \n         rad          tax      ptratio        lstat         medv \n2.693844e-56 2.357127e-47 2.942922e-11 2.654277e-27 1.173987e-19 \n```\n:::\n\n```{.r .cell-code}\npval[pval > 0.05]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     chas \n0.2094345 \n```\n:::\n:::\n\n\n\n\n\nb. Fit a multiple regression model to predict the response using all of the predictors. Describe your results. For which predictors can we reject the null hypothesis $H_0 : \\beta_j = 0$?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmlr <- lm(crim ~., data = Boston)\n(summ_mlr <- summary(mlr))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = crim ~ ., data = Boston)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-8.534 -2.248 -0.348  1.087 73.923 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 13.7783938  7.0818258   1.946 0.052271 .  \nzn           0.0457100  0.0187903   2.433 0.015344 *  \nindus       -0.0583501  0.0836351  -0.698 0.485709    \nchas        -0.8253776  1.1833963  -0.697 0.485841    \nnox         -9.9575865  5.2898242  -1.882 0.060370 .  \nrm           0.6289107  0.6070924   1.036 0.300738    \nage         -0.0008483  0.0179482  -0.047 0.962323    \ndis         -1.0122467  0.2824676  -3.584 0.000373 ***\nrad          0.6124653  0.0875358   6.997 8.59e-12 ***\ntax         -0.0037756  0.0051723  -0.730 0.465757    \nptratio     -0.3040728  0.1863598  -1.632 0.103393    \nlstat        0.1388006  0.0757213   1.833 0.067398 .  \nmedv        -0.2200564  0.0598240  -3.678 0.000261 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.46 on 493 degrees of freedom\nMultiple R-squared:  0.4493,\tAdjusted R-squared:  0.4359 \nF-statistic: 33.52 on 12 and 493 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n\nc. How do your results from (a) compare to your results from (b)? Create a plot displaying the univariate regression coefficients from (a) on the x-axis, and the multiple regression coefficients from (b) on the y-axis. That is, each predictor is displayed as a single point in the plot. Its coefficient in a simple linear regression model is shown on the x-axis, and its coefficient estimate in the multiple linear regression model is shown on the y-axis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoef_mlr <- summ_mlr$coef[-1, 1]\nplot(coef_slr, coef_mlr)\n```\n\n::: {.cell-output-display}\n![](ex-3-mlr-sol_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "ex-3-mlr-sol_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
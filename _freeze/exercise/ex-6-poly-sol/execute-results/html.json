{
  "hash": "e6b2b58a67ad551a2d0803dc1adf88e3",
  "result": {
    "markdown": "---\ntitle: \"Exercise 6: Polynomial Regression Solution\"\neditor: source\nreference-location: margin\n---\n\n\n::: callout-note\nExercises are for practice purpose only.\n:::\n\n\n\n## Polynomial Regression\n\n\n<!-- LRA 7.1 -->\n1. Consider the values of x shown below: \n$$x = 1.00, 1.70, 1.25, 1.20, 1.45, 1.85, 1.60, 1.50, 1.95, 2.00$$ Suppose that we wish to fit a second-order model using these levels for the regressor variable $x$. Calculate the correlation between $x$ and $x^2$. Do you see any potential difficulties in fitting the model?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- c(1.00, 1.70, 1.25, 1.20, 1.45, 1.85, 1.60, 1.50, 1.95, 2.00)\nx2 <- x ^ 2\ncor(x, x2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9954134\n```\n:::\n:::\n\n\n\n<!-- ISL 5.15 -->\n2. Is there evidence of non-linear association between any of the predictors and the response `crim` in the `Boston` data set? To answer this question, for each predictor $X$, fit a model of the form \n$$Y = \\beta_0 + \\beta_1X+\\beta_2X^2+\\beta_3X^3+\\epsilon$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ISLR2)\nname <- names(Boston)\n# 'degree' must be less than number of unique points\nfor (i in 2:13) {\n  if (name[i] == \"chas\") next\n  print(name[i])\n  poly_reg <- lm(Boston$crim ~ poly(Boston[[i]], degree = 3))\n  print(summary(poly_reg), digits = 2)\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"zn\"\n\nCall:\nlm(formula = Boston$crim ~ poly(Boston[[i]], degree = 3))\n\nResiduals:\n   Min     1Q Median     3Q    Max \n  -4.8   -4.6   -1.3    0.5   84.1 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                        3.61       0.37     9.7   <2e-16 ***\npoly(Boston[[i]], degree = 3)1   -38.75       8.37    -4.6    5e-06 ***\npoly(Boston[[i]], degree = 3)2    23.94       8.37     2.9    0.004 ** \npoly(Boston[[i]], degree = 3)3   -10.07       8.37    -1.2    0.230    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.4 on 502 degrees of freedom\nMultiple R-squared:  0.058,\tAdjusted R-squared:  0.053 \nF-statistic:  10 on 3 and 502 DF,  p-value: 1.3e-06\n\n[1] \"indus\"\n\nCall:\nlm(formula = Boston$crim ~ poly(Boston[[i]], degree = 3))\n\nResiduals:\n   Min     1Q Median     3Q    Max \n  -8.3   -2.5    0.1    0.8   79.7 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                        3.61       0.33    11.0   <2e-16 ***\npoly(Boston[[i]], degree = 3)1    78.59       7.42    10.6   <2e-16 ***\npoly(Boston[[i]], degree = 3)2   -24.39       7.42    -3.3    0.001 ** \npoly(Boston[[i]], degree = 3)3   -54.13       7.42    -7.3    1e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.4 on 502 degrees of freedom\nMultiple R-squared:  0.26,\tAdjusted R-squared:  0.26 \nF-statistic:  59 on 3 and 502 DF,  p-value: <2e-16\n\n[1] \"nox\"\n\nCall:\nlm(formula = Boston$crim ~ poly(Boston[[i]], degree = 3))\n\nResiduals:\n   Min     1Q Median     3Q    Max \n  -9.1   -2.1   -0.3    0.7   78.3 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                        3.61       0.32    11.2   <2e-16 ***\npoly(Boston[[i]], degree = 3)1    81.37       7.23    11.2   <2e-16 ***\npoly(Boston[[i]], degree = 3)2   -28.83       7.23    -4.0    8e-05 ***\npoly(Boston[[i]], degree = 3)3   -60.36       7.23    -8.3    7e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.2 on 502 degrees of freedom\nMultiple R-squared:  0.3,\tAdjusted R-squared:  0.29 \nF-statistic:  71 on 3 and 502 DF,  p-value: <2e-16\n\n[1] \"rm\"\n\nCall:\nlm(formula = Boston$crim ~ poly(Boston[[i]], degree = 3))\n\nResiduals:\n   Min     1Q Median     3Q    Max \n -18.5   -3.5   -2.2    0.0   87.2 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                        3.61       0.37     9.8   <2e-16 ***\npoly(Boston[[i]], degree = 3)1   -42.38       8.33    -5.1    5e-07 ***\npoly(Boston[[i]], degree = 3)2    26.58       8.33     3.2    0.002 ** \npoly(Boston[[i]], degree = 3)3    -5.51       8.33    -0.7    0.509    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.3 on 502 degrees of freedom\nMultiple R-squared:  0.068,\tAdjusted R-squared:  0.062 \nF-statistic:  12 on 3 and 502 DF,  p-value: 1.1e-07\n\n[1] \"age\"\n\nCall:\nlm(formula = Boston$crim ~ poly(Boston[[i]], degree = 3))\n\nResiduals:\n   Min     1Q Median     3Q    Max \n  -9.8   -2.7   -0.5    0.0   82.8 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                        3.61       0.35    10.4   <2e-16 ***\npoly(Boston[[i]], degree = 3)1    68.18       7.84     8.7   <2e-16 ***\npoly(Boston[[i]], degree = 3)2    37.48       7.84     4.8    2e-06 ***\npoly(Boston[[i]], degree = 3)3    21.35       7.84     2.7    0.007 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.8 on 502 degrees of freedom\nMultiple R-squared:  0.17,\tAdjusted R-squared:  0.17 \nF-statistic:  35 on 3 and 502 DF,  p-value: <2e-16\n\n[1] \"dis\"\n\nCall:\nlm(formula = Boston$crim ~ poly(Boston[[i]], degree = 3))\n\nResiduals:\n   Min     1Q Median     3Q    Max \n -10.8   -2.6    0.0    1.3   76.4 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                        3.61       0.33    11.1   <2e-16 ***\npoly(Boston[[i]], degree = 3)1   -73.39       7.33   -10.0   <2e-16 ***\npoly(Boston[[i]], degree = 3)2    56.37       7.33     7.7    8e-14 ***\npoly(Boston[[i]], degree = 3)3   -42.62       7.33    -5.8    1e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.3 on 502 degrees of freedom\nMultiple R-squared:  0.28,\tAdjusted R-squared:  0.27 \nF-statistic:  64 on 3 and 502 DF,  p-value: <2e-16\n\n[1] \"rad\"\n\nCall:\nlm(formula = Boston$crim ~ poly(Boston[[i]], degree = 3))\n\nResiduals:\n   Min     1Q Median     3Q    Max \n -10.4   -0.4   -0.3    0.2   76.2 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                         3.6        0.3    12.2   <2e-16 ***\npoly(Boston[[i]], degree = 3)1    120.9        6.7    18.1   <2e-16 ***\npoly(Boston[[i]], degree = 3)2     17.5        6.7     2.6    0.009 ** \npoly(Boston[[i]], degree = 3)3      4.7        6.7     0.7    0.482    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.7 on 502 degrees of freedom\nMultiple R-squared:  0.4,\tAdjusted R-squared:  0.4 \nF-statistic: 1.1e+02 on 3 and 502 DF,  p-value: <2e-16\n\n[1] \"tax\"\n\nCall:\nlm(formula = Boston$crim ~ poly(Boston[[i]], degree = 3))\n\nResiduals:\n   Min     1Q Median     3Q    Max \n -13.3   -1.4    0.0    0.5   76.9 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                         3.6        0.3    11.9   <2e-16 ***\npoly(Boston[[i]], degree = 3)1    112.7        6.8    16.4   <2e-16 ***\npoly(Boston[[i]], degree = 3)2     32.1        6.8     4.7    4e-06 ***\npoly(Boston[[i]], degree = 3)3     -8.0        6.8    -1.2      0.2    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.9 on 502 degrees of freedom\nMultiple R-squared:  0.37,\tAdjusted R-squared:  0.37 \nF-statistic:  98 on 3 and 502 DF,  p-value: <2e-16\n\n[1] \"ptratio\"\n\nCall:\nlm(formula = Boston$crim ~ poly(Boston[[i]], degree = 3))\n\nResiduals:\n   Min     1Q Median     3Q    Max \n  -6.8   -4.1   -1.7    1.4   82.7 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                        3.61       0.36    10.0   <2e-16 ***\npoly(Boston[[i]], degree = 3)1    56.05       8.12     6.9    2e-11 ***\npoly(Boston[[i]], degree = 3)2    24.77       8.12     3.1    0.002 ** \npoly(Boston[[i]], degree = 3)3   -22.28       8.12    -2.7    0.006 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.1 on 502 degrees of freedom\nMultiple R-squared:  0.11,\tAdjusted R-squared:  0.11 \nF-statistic:  21 on 3 and 502 DF,  p-value: 4.2e-13\n\n[1] \"lstat\"\n\nCall:\nlm(formula = Boston$crim ~ poly(Boston[[i]], degree = 3))\n\nResiduals:\n   Min     1Q Median     3Q    Max \n -15.2   -2.2   -0.5    0.1   83.4 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                        3.61       0.34    10.7   <2e-16 ***\npoly(Boston[[i]], degree = 3)1    88.07       7.63    11.5   <2e-16 ***\npoly(Boston[[i]], degree = 3)2    15.89       7.63     2.1     0.04 *  \npoly(Boston[[i]], degree = 3)3   -11.57       7.63    -1.5     0.13    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 7.6 on 502 degrees of freedom\nMultiple R-squared:  0.22,\tAdjusted R-squared:  0.21 \nF-statistic:  47 on 3 and 502 DF,  p-value: <2e-16\n\n[1] \"medv\"\n\nCall:\nlm(formula = Boston$crim ~ poly(Boston[[i]], degree = 3))\n\nResiduals:\n   Min     1Q Median     3Q    Max \n -24.4   -2.0   -0.4    0.4   73.7 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                        3.61       0.29    12.4   <2e-16 ***\npoly(Boston[[i]], degree = 3)1   -75.06       6.57   -11.4   <2e-16 ***\npoly(Boston[[i]], degree = 3)2    88.09       6.57    13.4   <2e-16 ***\npoly(Boston[[i]], degree = 3)3   -48.03       6.57    -7.3    1e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.6 on 502 degrees of freedom\nMultiple R-squared:  0.42,\tAdjusted R-squared:  0.42 \nF-statistic: 1.2e+02 on 3 and 502 DF,  p-value: <2e-16\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
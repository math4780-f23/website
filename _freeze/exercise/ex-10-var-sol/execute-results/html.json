{
  "hash": "fdbd38e176b42fc94cd1882b56af7c8b",
  "result": {
    "markdown": "---\ntitle: \"Exercise 10: Variable Selection Solution\"\neditor: source\nreference-location: margin\n---\n\n\n::: callout-note\nExercises are for practice purpose only.\n:::\n\n\n\n## Variable Selection\n\n<!-- Yu -->\n\n1. Consider `Boston` data with all variables except `chas`. Use `crim` as the response. Perform Best Subset Selection and Forward Selection.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ISLR2)\nlibrary(olsrr) ## 0.6.0 version\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'olsrr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:datasets':\n\n    rivers\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- lm(crim ~ . -chas, data = Boston)\nbest_sub <- olsrr::ols_step_best_subset(fit, metric = \"predrsq\")\nord <- order(best_sub$metrics$predrsq, decreasing = TRUE)\nbest_sub$metrics$predrsq[ord]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 0.4301165 0.4299981 0.4299437 0.4288504 0.4287760 0.4254916 0.4252542\n [8] 0.4220163 0.4122490 0.4098917 0.3822294\n```\n:::\n\n```{.r .cell-code}\nbest_sub$metrics$predictors[ord]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"zn indus nox dis rad tax ptratio medv\"             \n [2] \"zn nox dis rad tax ptratio medv\"                   \n [3] \"zn indus nox age dis rad tax ptratio medv\"         \n [4] \"zn nox dis rad ptratio medv\"                       \n [5] \"zn indus nox age dis rad tax ptratio lstat medv\"   \n [6] \"zn indus dis rad medv\"                             \n [7] \"zn indus nox rm age dis rad tax ptratio lstat medv\"\n [8] \"zn dis rad medv\"                                   \n [9] \"zn rad lstat\"                                      \n[10] \"rad lstat\"                                         \n[11] \"rad\"                                               \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nolsrr::ols_step_forward_p(fit, penter = 0.3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n                             Stepwise Summary                             \n------------------------------------------------------------------------\nStep    Variable        AIC         SBC       SBIC      R2       Adj. R2 \n------------------------------------------------------------------------\n 0      Base Model    3616.730    3625.183      NA    0.00000    0.00000 \n 1      rad           3367.573    3380.252      NA    0.39126    0.39005 \n 2      lstat         3344.403    3361.309      NA    0.42080    0.41849 \n 3      medv          3343.164    3364.297      NA    0.42449    0.42105 \n 4      ptratio       3341.763    3367.122      NA    0.42835    0.42378 \n 5      rm            3341.886    3371.471      NA    0.43046    0.42477 \n 6      nox           3342.355    3376.167      NA    0.43218    0.42536 \n 7      dis           3337.024    3375.063      NA    0.44035    0.43248 \n 8      zn            3333.209    3375.474      NA    0.44675    0.43784 \n 9      indus         3333.796    3380.288      NA    0.44829    0.43828 \n------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                         Model Summary                           \n----------------------------------------------------------------\nR                       0.670       RMSE                  6.383 \nR-Squared               0.448       MSE                  41.560 \nAdj. R-Squared          0.438       Coef. Var           178.405 \nPred R-Squared          0.426       AIC                3333.796 \nMAE                     2.873       SBC                3380.288 \n----------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                ANOVA                                  \n----------------------------------------------------------------------\n                 Sum of                                               \n                Squares         DF    Mean Square      F         Sig. \n----------------------------------------------------------------------\nRegression    16749.527          9       1861.059     44.78    0.0000 \nResidual      20613.695        496         41.560                     \nTotal         37363.222        505                                    \n----------------------------------------------------------------------\n\n                                   Parameter Estimates                                     \n------------------------------------------------------------------------------------------\n      model       Beta    Std. Error    Std. Beta      t        Sig       lower     upper \n------------------------------------------------------------------------------------------\n(Intercept)     13.182         6.970                  1.891    0.059     -0.512    26.877 \n        rad      0.561         0.049        0.568    11.471    0.000      0.465     0.657 \n      lstat      0.140         0.072        0.117     1.959    0.051      0.000     0.281 \n       medv     -0.220         0.058       -0.235    -3.782    0.000     -0.334    -0.106 \n    ptratio     -0.304         0.185       -0.077    -1.643    0.101     -0.668     0.060 \n         rm      0.635         0.595        0.052     1.067    0.287     -0.535     1.805 \n        nox    -10.468         5.077       -0.141    -2.062    0.040    -20.442    -0.494 \n        dis     -1.006         0.271       -0.246    -3.720    0.000     -1.538    -0.475 \n         zn      0.043         0.018        0.117     2.383    0.018      0.008     0.079 \n      indus     -0.088         0.075       -0.070    -1.178    0.239     -0.235     0.059 \n------------------------------------------------------------------------------------------\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nolsrr::ols_step_forward_aic(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n                             Stepwise Summary                             \n------------------------------------------------------------------------\nStep    Variable        AIC         SBC       SBIC      R2       Adj. R2 \n------------------------------------------------------------------------\n 0      Base Model    3616.730    3625.183      NA    0.00000    0.00000 \n 1      rad           3367.573    3380.252      NA    0.39126    0.39005 \n 2      lstat         3344.403    3361.309      NA    0.42080    0.41849 \n 3      medv          3343.164    3364.297      NA    0.42449    0.42105 \n 4      ptratio       3341.763    3367.122      NA    0.42835    0.42378 \n------------------------------------------------------------------------\n\nFinal Model Output \n------------------\n\n                         Model Summary                           \n----------------------------------------------------------------\nR                       0.654       RMSE                  6.497 \nR-Squared               0.428       MSE                  42.632 \nAdj. R-Squared          0.424       Coef. Var           180.692 \nPred R-Squared          0.414       AIC                3341.763 \nMAE                     2.792       SBC                3367.122 \n----------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n AIC: Akaike Information Criteria \n SBC: Schwarz Bayesian Criteria \n\n                                ANOVA                                  \n----------------------------------------------------------------------\n                 Sum of                                               \n                Squares         DF    Mean Square      F         Sig. \n----------------------------------------------------------------------\nRegression    16004.437          4       4001.109    93.852    0.0000 \nResidual      21358.785        501         42.632                     \nTotal         37363.222        505                                    \n----------------------------------------------------------------------\n\n                                  Parameter Estimates                                    \n----------------------------------------------------------------------------------------\n      model      Beta    Std. Error    Std. Beta      t        Sig      lower     upper \n----------------------------------------------------------------------------------------\n(Intercept)     4.936         3.887                  1.270    0.205    -2.700    12.573 \n        rad     0.548         0.041        0.554    13.343    0.000     0.467     0.628 \n      lstat     0.144         0.064        0.119     2.228    0.026     0.017     0.270 \n       medv    -0.120         0.051       -0.128    -2.365    0.018    -0.219    -0.020 \n    ptratio    -0.307         0.167       -0.077    -1.838    0.067    -0.635     0.021 \n----------------------------------------------------------------------------------------\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
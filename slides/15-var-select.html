<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">
<meta name="author" content="Dr.&nbsp;Cheng-Han Yu   Department of Mathematical and Statistical Sciences   Marquette University">
<title>MATH 4780 - Fall 2023 - Model Building, Selection and Validation</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
<link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css" id="theme">
<link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<script src="../site_libs/kePrint/kePrint.js"></script><link href="../site_libs/lightable/lightable.css" rel="stylesheet">
<meta property="og:title" content="MATH 4780 - Fall 2023 - Model Building, Selection and Validation">
<meta property="og:description" content="MATH 4780 / MSSC 5780 Regression Analysis">
<meta property="og:site-name" content="MATH 4780 - Fall 2023">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#447099" class="quarto-title-block center"><h1 class="title">Model Building, Selection and Validation</h1>
  <p class="subtitle">MATH 4780 / MSSC 5780 Regression Analysis</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Cheng-Han Yu <br> Department of Mathematical and Statistical Sciences <br> Marquette University 
</div>
</div>
</div>

</section><section><section id="model-building-selection-and-validation" class="title-slide slide level1 center"><h1>Model Building, Selection and Validation</h1>
<h2>
Model Building Process
</h2>
<h2>
Model Selection Criteria
</h2>
<h2>
Selection Methods
</h2>
</section><section id="model-building" class="slide level2"><h2>Model Building</h2>
<p>So far, we assume that we</p>
<ul>
<li>have a very good idea of the basic form of the model (linear form after transformation)</li>
<li>know (nearly) all of the regressors that are important and should be used.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Model Adequacy</strong></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="./images/15-var-select/model_building.png" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Model Selection</strong></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="./images/15-var-select/model_selection.png" style="width:26.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<aside class="notes"><p>Our strategy is - Fit the full model - Perform a thorough analysis (residual analysis, outliers, collinearity, etc) - Transformation of response/regressors - Test regressor significance - Perform a thorough analysis</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="variable-selection" class="slide level2"><h2>Variable Selection</h2>
<ul>
<li>We have a <em>large pool of <strong>candidate regressors</strong></em>, of which only a few are likely to be important.</li>
<li>Finding an appropriate subset of regressors for the model is called <strong>model/variable selection</strong>.</li>
</ul>
<div class="fragment">
<p>Two “conflicting” goals in model building:</p>
<ul>
<li><p>as many regressors as possible for better <em>predictive performance on new data</em> (<strong>smaller bias</strong>).</p></li>
<li>
<p>as few regressors as possible because as the number of regressors increases,</p>
<ul>
<li>
<span class="math inline">\(\mathrm{Var}(\hat{y})\)</span> will increase (<strong>larger variance</strong>)</li>
<li>cost more in data collecting and maintaining</li>
<li>more model complexity</li>
</ul>
</li>
</ul>
<p>A compromise between the two hopefully leads to the <em>“best” regression equation</em>.</p>
<div class="question">
<p>What does <strong>best</strong> mean?</p>
</div>
<aside class="notes"><ul>
<li>In most practical problems, we have a <em>large pool of possible <strong>candidate regressors</strong></em>, of which only a few are likely to be important.</li>
<li>Finding an appropriate subset of regressors for the model is called <strong>variable selection</strong>.</li>
<li>Two “conflicting” goals in model building:
<ul>
<li>as many regressors as possible for more information for prediction</li>
<li>as few regressors as possible (1) the variance of <span class="math inline">\(\hat{y}\)</span> will increase as the number of regressors increases (2) cost more in data collection (3) more model complexity</li>
</ul>
</li>
</ul>
<p>A compromise between the two hopefully leads to the <em>“best” regression equation</em>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
<div class="fragment">
<p>There is <strong>no unique definition of “best”</strong>, and different methods specify <strong>different subsets of the candidate regressors as best</strong>.</p>
<!-- --- -->
<!-- ## Model Misspecification -->
<!-- - *Exclusion of relevant variables (underspecified)* -->
<!--   + **True model**: ${\bf y = X_1\bsbeta_1 + X_2\bsbeta_2 + \bsep}$ -->
<!--   + **Underspecified model**: ${\bf y = X_1\bsbeta_1 + \bsdel}$ -->
<!-- - *Inclusion of irrelevant variables (overspecified)* -->
<!--   + **True model**: ${\bf y = X\bsbeta + \bsep}$ -->
<!--   + **Overspecified model**: ${\bf y = X\bsbeta + Z\bsgamma + \bsdel}$ -->
<!-- |Property         | Underfit | Overfit | -->
<!-- |:-------------------|:-------|:-------| -->
<!-- | Bias of $\small {\bf b}$        | $E[\small {\bf b_1}_{under}] \ne \bsbeta_1$ unless $\small {\bf X_1'X_2=0}$| $E[{\bf b}_{over}] = \bsbeta$ -->
<!-- | MSE                | $\small MSE({\bf b_1}_{under}) > MSE({\bf b_1})$ unless $\small {\bf X_1'X_2=0}$| $\small MSE({\bf b}_{over}) > MSE({\bf b})$ unless $\small {\bf X'Z=0}$ -->
<!-- | Bias of $\small \hat{\sigma}^2$ | $\small E[\hat{\sigma}^2_{under}] > \sigma^2$ even if $\small {\bf X_1'X_2=0}$| $\small E[\hat{\sigma}^2_{over}] = \sigma^2$ -->
</div>
</section><section id="predictive-performance" class="slide level2"><h2>Predictive Performance</h2>
<ul>
<li>A selected model that fits the observed sample data well may not predict well on new observations.</li>
<li>Build a good regression function/model in terms of <strong>prediction accuracy</strong>. (Model validation/assessment)</li>
<li>Want: The selected model minimizes the mean square prediction error (MSPE) on the <em>new data</em>: <span class="math display">\[\small MSPE(\hat{y}) = E\left[ (\hat{y} - y)^2\right] = E\left[ (\hat{y} - E(\hat{y}))^2\right] + [E(\hat{y}) - y]^2 = \mathrm{Var}(\hat{y}) + \text{Bias}^2(\hat{y})\]</span>
</li>
</ul>
<div class="fragment">
<ul>
<li>The mechanics of prediction is <strong>easy</strong>:
<ul>
<li>Plug in values of predictors to the model equation.</li>
<li>Calculate the predicted value of the response <span class="math inline">\(\hat{y}\)</span>
</li>
</ul>
</li>
</ul>
<aside class="notes"><ul>
<li>So, the mechanics of prediction is <strong>easy</strong>:
<ul>
<li>Once you have your model, you can Plug in values of predictors to the model equation</li>
<li>Calculate the predicted value of the response variable, <span class="math inline">\(\hat{y}\)</span>, either numerical or categorical.</li>
</ul>
</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
<div class="fragment">
<ul>
<li>Getting it right is <strong>hard</strong>! <strong>No guarantee that</strong>
<ul>
<li>the model estimates are close to the truth</li>
<li>your model performs as well with new data as it did with your sample data</li>
</ul>
</li>
</ul>
<aside class="notes"><ul>
<li>But Getting it right is <strong>hard</strong>!
<ul>
<li>There is no guarantee the model estimates you have are correct</li>
<li>Or that your model will perform as well with new data as it did with your sample data</li>
</ul>
</li>
<li>Test data are the new data that are not used for training or fitting our model, but the data we are interested in predicting its value.</li>
<li>So we care about the prediction performance on the test data much more than the performance on the training data.</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="spending-our-data" class="slide level2"><h2>Spending Our Data</h2>
<ul>
<li>Several steps to create a useful model:
<ul>
<li>Parameter estimation</li>
<li>Model building and selection</li>
<li>Performance assessment, etc.</li>
</ul>
</li>
</ul>
<div class="fragment">
<ul>
<li>Doing all of this on the entire data may lead to <strong>overfitting</strong>:</li>
</ul>
<p><br></p>
<blockquote>
<p><em>The model performs well on the current sample data, but awfully predicts the response on the new data we are interested.</em></p>
</blockquote>
<p><br></p>
<!-- - **Allocate specific subsets of data for different tasks**, as opposed to allocating the largest possible amount to the model parameter estimation only (what we've done so far). -->
<aside class="notes"><ul>
<li>When we are doing modeling, we are doing several steps to create a useful model,
<ul>
<li>parameter estimation</li>
<li>model selection</li>
<li>performance assessment, etc.</li>
</ul>
</li>
<li>Doing all of this on the entire data we have available may lead to <strong>overfitting</strong>. In classification, it means that our model labels the training response variable almost perfectly with very high classification accuracy, but the model performs very bad when fitted to the test data or incoming future emails for example.</li>
</ul>
<!-- - What we wanna do is to  **Allocate specific subsets of data for different tasks**, as opposed to allocating the largest possible amount of the data to the model parameter estimation only which is exactly what we've done so far. Remember in linear regression, we also use the entire data set to train our linear regression model, and estimate the regression coefficients. --><!-- - But now, if we wanna make sure that our model is good at predicting things, we probably want to avoid overfitting. And how? --><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="overfitting" class="slide level2"><h2>Overfitting</h2>
<blockquote>
<p><em>The model performs well on the current sample data, but awfully predicts the response on the new data we are interested.</em></p>
</blockquote>
<ul>
<li><strong>Low error rate on observed data, but high prediction error rate on future unobserved data!</strong></li>
</ul>

<img data-src="./images/15-var-select/overfit_reg.png" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption">Source: https://i.pinimg.com/originals/72/e2/22/72e222c1542539754df1d914cb671bd7.png</p><aside class="notes"><p>https://i.pinimg.com/originals/72/e2/22/72e222c1542539754df1d914cb671bd7.png - Look at this illustration, and let’s focus on the overfitting and classification case. - the blue and red points are our training data representing two categories, and the green points are the new data to be classified. - the black curve is the classification boundary that separates the two categories. - Based on the boundary, you can see that the classification performance on the training data set is perfect, because all blue points and red points are perfectly separated. - However, such classification rule generated by the training data may not be good for the new data. - With this boundary, … - OK so, if we wanna make sure that our model is good at predicting things, we probably want to avoid overfitting. - But how?</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="splitting-data" class="slide level2"><h2>Splitting Data</h2>
<ul>
<li><p>Often, we don’t have another unused data to assess the performance of our model.</p></li>
<li><p>Solution: Pretend we have new data by splitting our data into <strong>training set</strong> and <strong>test set (validation set)</strong>!</p></li>
</ul>
<div class="fragment">
<ul>
<li>
<strong>Training set:</strong>
<ul>
<li>Sandbox for model building/selection</li>
<li>Spend most of your time using the training set to develop the model</li>
<li>Majority of the original sample data (usually ~ 80%)</li>
</ul>
</li>
<li>
<strong>Test set:</strong>
<ul>
<li>Held in reserve to determine efficacy of one or two chosen models</li>
<li>Critical to look at it <em>once only</em>, otherwise it becomes part of the modeling process</li>
<li>Remainder of the data (usually ~ 20%)</li>
</ul>
</li>
</ul>
<aside class="notes"><ul>
<li>
<strong>Allocate specific subsets of data for different tasks</strong>, as opposed to allocating the largest possible amount to the model parameter estimation only (what we’ve done so far).</li>
<li>Well we do this by splitting our data. So we split our data into to sets, training set and testing set, or sometimes called validation set.</li>
<li>You can think about your training set as your sandbox for model building. You can do whatever you want, like data wrangling, data transformation, data tidying, and data visualization, all of which help you build an appropriate model.</li>
<li>So you Spend most of your time using the training set to develop the model</li>
<li>And this is the Majority of the original sample data, which is usually about 75% - 80% of your data. So you basically take a random sample from the data that is about 80% of it.</li>
<li>And you don’t touch the remaining 20% of the data until you are ready to test your model performance.</li>
<li>So the test set is held in reserve to determine efficacy of one or two chosen models</li>
<li>Critical to look at it once, otherwise it becomes part of the modeling process</li>
<li>and that is the Remainder of the data, usually 20% - 25%</li>
<li>So ideally, we hope to use our entire data as training data to train our model, right? And to test the model performance, we just collect another data set as test data to be used for testing performance. But in reality, it is not the usual case. In reality, we only have one single data set, and it is hard to collect another sample data as test data.</li>
<li>So under this situation, this type of splitting data becomes a must if we want to have both training and test data.</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="model-selection-criteria" class="slide level2"><h2>Model Selection Criteria</h2>
<ul>
<li><p>The full (largest) model has <span class="math inline">\(M\)</span> candidate regressors.</p></li>
<li><p>There are <span class="math inline">\(M \choose p-1\)</span> possible subset models of size <span class="math inline">\(p\)</span>.</p></li>
<li><p>There are totally <span class="math inline">\(2^M\)</span> possible subset models.</p></li>
<li><p>An evaluation metric should consider <strong>Goodness of Fit</strong> and <strong>Model Complexity</strong>:</p></li>
</ul>
<blockquote>
<p><strong>Goodness of Fit</strong>: The more regressors, the better</p>
</blockquote>
<blockquote>
<p><strong>Complexity Penalty</strong>: The less regressors, the better</p>
</blockquote>
<div class="fragment">
<ul>
<li>Evaluate subset models:
<ul>
<li>
<span class="math inline">\(R_{adj}^2\)</span> <span class="math inline">\(\uparrow\)</span>
</li>
<li>Mallow’s <span class="math inline">\(C_p\)</span> <span class="math inline">\(\downarrow\)</span>
</li>
<li>Information Criterion (AIC, BIC) <span class="math inline">\(\downarrow\)</span>
</li>
<li>
<strong>PRE</strong>diction <strong>S</strong>um of <strong>S</strong>quares (PRESS) <span class="math inline">\(\downarrow\)</span> (Allen, D.M. (1974))</li>
</ul>
</li>
</ul>
<aside class="notes"><ul>
<li>
<span class="math inline">\(R^2\)</span> <span class="math inline">\(\uparrow\)</span>
</li>
<li>
<span class="math inline">\(MS_{res}\)</span> <span class="math inline">\(\downarrow\)</span>
</li>
<li>The idea of model selection is to apply some penalty on the number of parameters used in the model. On one hand, we want to model fitting to be as good as possible, i.e., the mean squared error is small. On the other hand, we also want to restrict on the number of variables. We know that as we keep adding variables into a linear regression, the R2 would usually increase. Hence, there is a trade-off between the two. In general, we consider a criterion in the form of</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="selection-criteria-mallows-c_p-statistic-downarrow" class="slide level2"><h2>Selection Criteria: Mallow’s <span class="math inline">\(C_p\)</span> Statistic <span class="math inline">\(\downarrow\)</span>
</h2>
<p>For a model with <span class="math inline">\(p\)</span> coefficients ( <span class="math inline">\(k\)</span> predictors ),</p>
<p><span class="math display">\[\begin{align} C_p &amp;= \frac{SS_{res}(p)}{\hat{\sigma}^2} - n + 2p \\ &amp;= p + \frac{(s^2 - \hat{\sigma}^2)(n-p)}{\hat{\sigma}^2} \end{align}\]</span></p>
<ul>
<li><p><span class="math inline">\(\hat{\sigma}^2\)</span> is the variance estimate from the <em>full</em> model, i.e., <span class="math inline">\(\hat{\sigma}^2 = MS_{res}(M)\)</span>.</p></li>
<li><p><span class="math inline">\(s^2\)</span> is the variance estimate from the model with <span class="math inline">\(p\)</span> coefficients, i.e., <span class="math inline">\(s^2 = MS_{res}(p)\)</span>.</p></li>
<li><p>Favors the candidate model with the <strong>smallest <span class="math inline">\(C_p\)</span></strong>.</p></li>
<li>
<p>For unbiased models that <span class="math inline">\(E[\hat{y}_i] = E[y_i]\)</span>, <span class="math inline">\(C_p = p\)</span>.</p>
<ul>
<li>All of the errors in <span class="math inline">\(\hat{y}_i\)</span> is variance, and the model is not underfitted.</li>
</ul>
</li>
</ul>
<aside class="notes"><ul>
<li>
<span class="math inline">\(C_p = M + 1\)</span> for the full model.</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="mallows-c_p-plot" class="slide level2"><h2>Mallow’s <span class="math inline">\(C_p\)</span> Plot</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="./images/15-var-select/unnamed-chunk-5-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>Model A is a heavily biased model.</li>
<li>Model D is the poorest performer.</li>
<li>Model B and C are reasonable.</li>
<li>Model C has <span class="math inline">\(C_p &lt; 3\)</span> which implies <span class="math inline">\(MS_{res}(3) &lt; MS_{res}(M)\)</span>
</li>
</ul>
</div>
</div>
</section><section id="selection-criteria-information-criterion-downarrow" class="slide level2"><h2>Selection Criteria: Information Criterion <span class="math inline">\(\downarrow\)</span>
</h2>
<p>For a model with <span class="math inline">\(p\)</span> coefficients ( <span class="math inline">\(k\)</span> predictors ),</p>
<ul>
<li>Akaike information criterion (AIC) is <span class="math display">\[\text{AIC} = n \ln \left( \frac{SS_{res}(p)}{n} \right) + 2p\]</span>
</li>
<li>Bayesian information criterion (BIC) is <span class="math display">\[\text{BIC} = n \ln \left( \frac{SS_{res}(p)}{n} \right) + p \ln (n)\]</span>
</li>
<li>BIC penalizes more when adding more variables as the sample size increases.</li>
<li>BIC tends to choose models with less regressors.</li>
</ul></section><section id="selection-criteria-press-downarrow" class="slide level2"><h2>Selection Criteria: PRESS <span class="math inline">\(\downarrow\)</span>
</h2>
<ul>
<li><p>Predicted Residual Error Sum of Squares (PRESS)</p></li>
<li><p><span class="math inline">\(\text{PRESS}_p = \sum_{i=1}^n[y_i - \hat{y}_{(i)}]^2 = \sum_{i=1}^n\left( \frac{e_i}{1-h_{ii}}\right)^2\)</span> where <span class="math inline">\(e_i = y_i - \hat{y}_i\)</span>.</p></li>
<li><p><span class="math inline">\(R_{pred, p}^2 = 1 - \frac{PRESS_p}{SS_T}\)</span></p></li>
<li><p><span class="math inline">\(\text{Absolute PRESS}_p = \sum_{i=1}^n|y_i - \hat{y}_{(i)}|\)</span> can also be considered when some large prediction errors are too influential.</p></li>
</ul></section><section id="r-lab-criteria-computation" class="slide level2"><h2>
<span class="pink">R Lab</span> Criteria Computation</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>manpower <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"./data/manpower.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>lm_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4 <span class="sc">+</span> x5, </span>
<span id="cb1-3"><a href="#cb1-3"></a>              <span class="at">data =</span> manpower)</span>
<span id="cb1-4"><a href="#cb1-4"></a>summ_full <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_full)</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="do">## Adjusted R sq.</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>summ_full<span class="sc">$</span>adj.r.squared  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.987</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># PRESS</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">sum</span>((lm_full<span class="sc">$</span>residual <span class="sc">/</span> </span>
<span id="cb3-3"><a href="#cb3-3"></a>       (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">hatvalues</span>(lm_full))) <span class="sc">^</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32195222</code></pre>
</div>
</div>
<!-- - `AIC()` calculating AIC using -2 log-likelihood. -->
<ul>
<li>
<code>ols_mallows_cp()</code> for Mallow’s <span class="math inline">\(C_p\)</span> in <a href="https://olsrr.rsquaredacademy.com/"><code>olsrr</code></a> package</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="do">## AIC</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">extractAIC</span>(lm_full, <span class="at">k =</span> <span class="dv">2</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   6 224</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="do">## BIC</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(manpower<span class="sc">$</span>y)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="fu">extractAIC</span>(lm_full, <span class="at">k =</span> <span class="fu">log</span>(n)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   6 229</code></pre>
</div>
</div>
<!-- # ```{r} -->
<!-- # #| out-width: 50% -->
<!-- # knitr::include_graphics("./images/15-var-select/hex_olsrr.png") -->
<!-- # ``` -->
<div class="quarto-figure quarto-figure-center">
<figure><p><a href="https://olsrr.rsquaredacademy.com/"><img data-src="./images/15-var-select/hex_olsrr.png" style="width:50.0%;height:50.0%"></a></p>
</figure>
</div>
</div>
</div>
<aside class="notes"><div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' -130 (df=7)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 224</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 229</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.43</code></pre>
</div>
</div>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="selection-methods-best-subset-all-possible-selection" class="slide level2"><h2>Selection Methods: Best Subset (All Possible) Selection</h2>
<ul>
<li>Assume the intercept is in all models.</li>
<li>If there are <span class="math inline">\(M\)</span> possible regressors, we investigate all <span class="math inline">\(2^M - 1\)</span> possible regression equations.</li>
<li>Use the selection criteria to determine some candidate models and complete regression analysis on them.</li>
<li>If the estimates of a particular coefficient tends to “jump around”, this could be an indication of collinearity.</li>
</ul></section><section id="r-lab-best-subset-selection-ols_step_all_possible" class="slide level2"><h2>
<span class="pink">R Lab</span> Best Subset Selection <code>ols_step_all_possible()</code>
</h2>
<!-- - The `ols_step_all_possible()` function in [`olsrr`](https://olsrr.rsquaredacademy.com/) package. -->
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>olsrr_all <span class="ot">&lt;-</span> olsrr<span class="sc">::</span><span class="fu">ols_step_all_possible</span>(lm_full)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="fu">names</span>(olsrr_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "mindex"     "n"          "predictors" "rsquare"    "adjr"      
 [6] "predrsq"    "cp"         "aic"        "sbic"       "sbc"       
[11] "msep"       "fpe"        "apc"        "hsp"       </code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>
<code>n</code>: number of predictors</li>
<li>
<code>predictors</code>: predictors in the model</li>
<li>
<code>rsquare</code>: R-square of the model</li>
<li>
<code>adjr</code>: adjusted R-square of the model</li>
<li>
<code>predrsq</code>: predicted R-square of the model</li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li>
<code>cp</code>: Mallow’s Cp</li>
<li>
<code>aic</code>: AIC</li>
<li>
<code>sbic</code>: Sawa BIC</li>
<li>
<code>sbc</code>: Schwarz BIC (the one we defined)</li>
</ul>
</div>
</div>
</section><section id="section-1" class="slide level2"><h2></h2>
<div class="small">
<p>Model (x2 x3 x5)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource my_classfull number-lines code-with-copy"><code class="sourceCode"><span id="cb15-1"><a href="#cb15-1"></a>   Index N     Predictors R-Square Adj. R-Square Mallow's Cp</span>
<span id="cb15-2"><a href="#cb15-2"></a>3      1 1             x3    0.972         0.970       20.38</span>
<span id="cb15-3"><a href="#cb15-3"></a>1      2 1             x1    0.971         0.970       21.20</span>
<span id="cb15-4"><a href="#cb15-4"></a>2      3 1             x2    0.893         0.886      114.97</span>
<span id="cb15-5"><a href="#cb15-5"></a>4      4 1             x4    0.884         0.877      125.87</span>
<span id="cb15-6"><a href="#cb15-6"></a>5      5 1             x5    0.335         0.290      785.26</span>
<span id="cb15-7"><a href="#cb15-7"></a>10     6 2          x2 x3    0.987         0.985        4.94</span>
<span id="cb15-8"><a href="#cb15-8"></a>6      7 2          x1 x2    0.986         0.984        5.66</span>
<span id="cb15-9"><a href="#cb15-9"></a>14     8 2          x3 x5    0.985         0.983        7.29</span>
<span id="cb15-10"><a href="#cb15-10"></a>9      9 2          x1 x5    0.984         0.982        8.16</span>
<span id="cb15-11"><a href="#cb15-11"></a>13    10 2          x3 x4    0.975         0.972       18.57</span>
<span id="cb15-12"><a href="#cb15-12"></a>8     11 2          x1 x4    0.974         0.970       20.04</span>
<span id="cb15-13"><a href="#cb15-13"></a>7     12 2          x1 x3    0.973         0.969       21.99</span>
<span id="cb15-14"><a href="#cb15-14"></a>11    13 2          x2 x4    0.931         0.921       72.29</span>
<span id="cb15-15"><a href="#cb15-15"></a>12    14 2          x2 x5    0.924         0.913       80.30</span>
<span id="cb15-16"><a href="#cb15-16"></a>15    15 2          x4 x5    0.910         0.898       96.50</span>
<span id="cb15-17"><a href="#cb15-17"></a>23    16 3       x2 x3 x5    0.990         0.988        2.92</span>
<span id="cb15-18"><a href="#cb15-18"></a>18    17 3       x1 x2 x5    0.989         0.987        3.71</span>
<span id="cb15-19"><a href="#cb15-19"></a>16    18 3       x1 x2 x3    0.987         0.984        6.21</span>
<span id="cb15-20"><a href="#cb15-20"></a>22    19 3       x2 x3 x4    0.987         0.984        6.90</span>
<span id="cb15-21"><a href="#cb15-21"></a>17    20 3       x1 x2 x4    0.986         0.983        7.66</span>
<span id="cb15-22"><a href="#cb15-22"></a>20    21 3       x1 x3 x5    0.985         0.982        8.97</span>
<span id="cb15-23"><a href="#cb15-23"></a>25    22 3       x3 x4 x5    0.985         0.982        9.00</span>
<span id="cb15-24"><a href="#cb15-24"></a>21    23 3       x1 x4 x5    0.985         0.981        9.41</span>
<span id="cb15-25"><a href="#cb15-25"></a>19    24 3       x1 x3 x4    0.978         0.974       16.80</span>
<span id="cb15-26"><a href="#cb15-26"></a>24    25 3       x2 x4 x5    0.952         0.941       48.28</span>
<span id="cb15-27"><a href="#cb15-27"></a>30    26 4    x2 x3 x4 x5    0.991         0.988        4.03</span>
<span id="cb15-28"><a href="#cb15-28"></a>28    27 4    x1 x2 x4 x5    0.991         0.987        4.26</span>
<span id="cb15-29"><a href="#cb15-29"></a>27    28 4    x1 x2 x3 x5    0.991         0.987        4.35</span>
<span id="cb15-30"><a href="#cb15-30"></a>26    29 4    x1 x2 x3 x4    0.988         0.984        7.54</span>
<span id="cb15-31"><a href="#cb15-31"></a>29    30 4    x1 x3 x4 x5    0.985         0.980       10.92</span>
<span id="cb15-32"><a href="#cb15-32"></a>31    31 5 x1 x2 x3 x4 x5    0.991         0.987        6.00</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<aside class="notes"><div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 275</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 273</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 224</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 280</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 278</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 229</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 278</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 280</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 232</code></pre>
</div>
</div>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="r-lab-ols_step_best_subset" class="slide level2"><h2>
<span class="pink">R Lab</span> <code>ols_step_best_subset()</code>
</h2>
<div class="small">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># metric = c("rsquare", "adjr", "predrsq", "cp", "aic", "sbic", "sbc", "msep", "fpe", "apc", "hsp")</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>olsrr<span class="sc">::</span><span class="fu">ols_step_best_subset</span>(lm_full, <span class="at">metric =</span> <span class="st">"predrsq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb26"><pre class="sourceCode numberSource my_classfull number-lines code-with-copy"><code class="sourceCode"><span id="cb26-1"><a href="#cb26-1"></a>   Best Subsets Regression   </span>
<span id="cb26-2"><a href="#cb26-2"></a>-----------------------------</span>
<span id="cb26-3"><a href="#cb26-3"></a>Model Index    Predictors</span>
<span id="cb26-4"><a href="#cb26-4"></a>-----------------------------</span>
<span id="cb26-5"><a href="#cb26-5"></a>     1         x3             </span>
<span id="cb26-6"><a href="#cb26-6"></a>     2         x2 x3          </span>
<span id="cb26-7"><a href="#cb26-7"></a>     3         x2 x3 x5       </span>
<span id="cb26-8"><a href="#cb26-8"></a>     4         x2 x3 x4 x5    </span>
<span id="cb26-9"><a href="#cb26-9"></a>     5         x1 x2 x3 x4 x5 </span>
<span id="cb26-10"><a href="#cb26-10"></a>-----------------------------</span>
<span id="cb26-11"><a href="#cb26-11"></a></span>
<span id="cb26-12"><a href="#cb26-12"></a>                                                           Subsets Regression Summary                                                            </span>
<span id="cb26-13"><a href="#cb26-13"></a>-------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="cb26-14"><a href="#cb26-14"></a>                       Adj.        Pred                                                                                                           </span>
<span id="cb26-15"><a href="#cb26-15"></a>Model    R-Square    R-Square    R-Square     C(p)        AIC         SBIC        SBC           MSEP             FPE            HSP         APC  </span>
<span id="cb26-16"><a href="#cb26-16"></a>-------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="cb26-17"><a href="#cb26-17"></a>  1        0.9722      0.9703       0.956    20.3812    285.5158    234.8274    288.0155    15612703.3319    1025426.9349    65534.8041    0.0352 </span>
<span id="cb26-18"><a href="#cb26-18"></a>  2        0.9867      0.9848       0.964     4.9416    274.9519    227.0975    278.2847     8029607.6257     552301.0536    36111.9920    0.0190 </span>
<span id="cb26-19"><a href="#cb26-19"></a>  3        0.9901      0.9878       0.964     2.9177    272.0064    226.8104    276.1724     6503027.4301     466884.0206    31496.1442    0.0160 </span>
<span id="cb26-20"><a href="#cb26-20"></a>  4        0.9908      0.9877       0.942     4.0263    272.6849    229.2716    277.6841     6563621.8068     490245.8263    34438.7564    0.0168 </span>
<span id="cb26-21"><a href="#cb26-21"></a>  5        0.9908      0.9867       0.935     6.0000    274.6442    232.3507    280.4767     7202730.2305     557787.1896    41227.7488    0.0192 </span>
<span id="cb26-22"><a href="#cb26-22"></a>-------------------------------------------------------------------------------------------------------------------------------------------------</span>
<span id="cb26-23"><a href="#cb26-23"></a>AIC: Akaike Information Criteria </span>
<span id="cb26-24"><a href="#cb26-24"></a> SBIC: Sawa's Bayesian Information Criteria </span>
<span id="cb26-25"><a href="#cb26-25"></a> SBC: Schwarz Bayesian Criteria </span>
<span id="cb26-26"><a href="#cb26-26"></a> MSEP: Estimated error of prediction, assuming multivariate normality </span>
<span id="cb26-27"><a href="#cb26-27"></a> FPE: Final Prediction Error </span>
<span id="cb26-28"><a href="#cb26-28"></a> HSP: Hocking's Sp </span>
<span id="cb26-29"><a href="#cb26-29"></a> APC: Amemiya Prediction Criteria </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<aside class="notes"><ul>
<li>
<code>ols_step_best_subset()</code> identifies the best model of each size using <span class="math inline">\(R^2\)</span> by default.</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="r-lab-best-subset-selection" class="slide level2"><h2>
<span class="pink">R Lab</span> Best Subset Selection</h2>
<div class="cell" data-layout-align="center">

</div>
<div class="cell" data-layout-align="center">

</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">

<table class="table table-striped" style="font-size: 21px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;"> k </th>
   <th style="text-align:right;"> 1 </th>
   <th style="text-align:right;"> 2 </th>
   <th style="text-align:right;"> 3 </th>
   <th style="text-align:right;"> 4 </th>
   <th style="text-align:right;"> 5 </th>
   <th style="text-align:right;"> r2 </th>
   <th style="text-align:right;"> adj_r2 </th>
   <th style="text-align:right;"> cp </th>
   <th style="text-align:right;"> press </th>
   <th style="text-align:right;"> abs_press </th>
   <th style="text-align:right;"> r2_pred </th>
   <th style="text-align:right;"> aic </th>
   <th style="text-align:right;"> bic </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.972 </td>
   <td style="text-align:right;"> 0.970 </td>
   <td style="text-align:right;"> 20.38 </td>
   <td style="text-align:right;"> 2.18e+07 </td>
   <td style="text-align:right;"> 13431 </td>
   <td style="text-align:right;"> 0.956 </td>
   <td style="text-align:right;"> 235 </td>
   <td style="text-align:right;"> 237 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.971 </td>
   <td style="text-align:right;"> 0.970 </td>
   <td style="text-align:right;"> 21.20 </td>
   <td style="text-align:right;"> 2.22e+07 </td>
   <td style="text-align:right;"> 13666 </td>
   <td style="text-align:right;"> 0.955 </td>
   <td style="text-align:right;"> 236 </td>
   <td style="text-align:right;"> 237 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.893 </td>
   <td style="text-align:right;"> 0.886 </td>
   <td style="text-align:right;"> 114.97 </td>
   <td style="text-align:right;"> 1.58e+08 </td>
   <td style="text-align:right;"> 28031 </td>
   <td style="text-align:right;"> 0.680 </td>
   <td style="text-align:right;"> 258 </td>
   <td style="text-align:right;"> 260 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.884 </td>
   <td style="text-align:right;"> 0.877 </td>
   <td style="text-align:right;"> 125.87 </td>
   <td style="text-align:right;"> 7.01e+07 </td>
   <td style="text-align:right;"> 22890 </td>
   <td style="text-align:right;"> 0.858 </td>
   <td style="text-align:right;"> 260 </td>
   <td style="text-align:right;"> 261 </td>
  </tr>
<tr>
<td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.335 </td>
   <td style="text-align:right;"> 0.290 </td>
   <td style="text-align:right;"> 785.26 </td>
   <td style="text-align:right;"> 4.56e+08 </td>
   <td style="text-align:right;"> 61324 </td>
   <td style="text-align:right;"> 0.079 </td>
   <td style="text-align:right;"> 289 </td>
   <td style="text-align:right;"> 291 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.987 </td>
   <td style="text-align:right;"> 0.985 </td>
   <td style="text-align:right;"> 4.94 </td>
   <td style="text-align:right;"> 1.79e+07 </td>
   <td style="text-align:right;"> 12742 </td>
   <td style="text-align:right;"> 0.964 </td>
   <td style="text-align:right;"> 225 </td>
   <td style="text-align:right;"> 227 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.986 </td>
   <td style="text-align:right;"> 0.984 </td>
   <td style="text-align:right;"> 5.66 </td>
   <td style="text-align:right;"> 1.80e+07 </td>
   <td style="text-align:right;"> 12873 </td>
   <td style="text-align:right;"> 0.964 </td>
   <td style="text-align:right;"> 225 </td>
   <td style="text-align:right;"> 228 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.985 </td>
   <td style="text-align:right;"> 0.983 </td>
   <td style="text-align:right;"> 7.29 </td>
   <td style="text-align:right;"> 1.26e+07 </td>
   <td style="text-align:right;"> 10915 </td>
   <td style="text-align:right;"> 0.974 </td>
   <td style="text-align:right;"> 227 </td>
   <td style="text-align:right;"> 230 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.984 </td>
   <td style="text-align:right;"> 0.982 </td>
   <td style="text-align:right;"> 8.16 </td>
   <td style="text-align:right;"> 1.30e+07 </td>
   <td style="text-align:right;"> 11074 </td>
   <td style="text-align:right;"> 0.974 </td>
   <td style="text-align:right;"> 228 </td>
   <td style="text-align:right;"> 230 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.975 </td>
   <td style="text-align:right;"> 0.972 </td>
   <td style="text-align:right;"> 18.57 </td>
   <td style="text-align:right;"> 3.25e+07 </td>
   <td style="text-align:right;"> 16825 </td>
   <td style="text-align:right;"> 0.934 </td>
   <td style="text-align:right;"> 235 </td>
   <td style="text-align:right;"> 238 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.974 </td>
   <td style="text-align:right;"> 0.970 </td>
   <td style="text-align:right;"> 20.04 </td>
   <td style="text-align:right;"> 3.58e+07 </td>
   <td style="text-align:right;"> 17328 </td>
   <td style="text-align:right;"> 0.928 </td>
   <td style="text-align:right;"> 236 </td>
   <td style="text-align:right;"> 239 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.973 </td>
   <td style="text-align:right;"> 0.969 </td>
   <td style="text-align:right;"> 21.99 </td>
   <td style="text-align:right;"> 2.26e+07 </td>
   <td style="text-align:right;"> 13957 </td>
   <td style="text-align:right;"> 0.954 </td>
   <td style="text-align:right;"> 237 </td>
   <td style="text-align:right;"> 240 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.931 </td>
   <td style="text-align:right;"> 0.921 </td>
   <td style="text-align:right;"> 72.29 </td>
   <td style="text-align:right;"> 1.41e+08 </td>
   <td style="text-align:right;"> 28166 </td>
   <td style="text-align:right;"> 0.716 </td>
   <td style="text-align:right;"> 253 </td>
   <td style="text-align:right;"> 255 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.924 </td>
   <td style="text-align:right;"> 0.913 </td>
   <td style="text-align:right;"> 80.30 </td>
   <td style="text-align:right;"> 1.29e+08 </td>
   <td style="text-align:right;"> 25960 </td>
   <td style="text-align:right;"> 0.740 </td>
   <td style="text-align:right;"> 254 </td>
   <td style="text-align:right;"> 257 </td>
  </tr>
<tr>
<td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.910 </td>
   <td style="text-align:right;"> 0.898 </td>
   <td style="text-align:right;"> 96.50 </td>
   <td style="text-align:right;"> 7.12e+07 </td>
   <td style="text-align:right;"> 25251 </td>
   <td style="text-align:right;"> 0.856 </td>
   <td style="text-align:right;"> 257 </td>
   <td style="text-align:right;"> 260 </td>
  </tr>
</tbody>
</table>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">

<table class="table table-striped" style="font-size: 21px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;"> k </th>
   <th style="text-align:right;"> 1 </th>
   <th style="text-align:right;"> 2 </th>
   <th style="text-align:right;"> 3 </th>
   <th style="text-align:right;"> 4 </th>
   <th style="text-align:right;"> 5 </th>
   <th style="text-align:right;"> r2 </th>
   <th style="text-align:right;"> adj_r2 </th>
   <th style="text-align:right;"> cp </th>
   <th style="text-align:right;"> press </th>
   <th style="text-align:right;"> abs_press </th>
   <th style="text-align:right;"> r2_pred </th>
   <th style="text-align:right;"> aic </th>
   <th style="text-align:right;"> bic </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.990 </td>
   <td style="text-align:right;"> 0.988 </td>
   <td style="text-align:right;"> 2.92 </td>
   <td style="text-align:right;"> 1.78e+07 </td>
   <td style="text-align:right;"> 12019 </td>
   <td style="text-align:right;"> 0.964 </td>
   <td style="text-align:right;"> 222 </td>
   <td style="text-align:right;"> 225 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.989 </td>
   <td style="text-align:right;"> 0.987 </td>
   <td style="text-align:right;"> 3.71 </td>
   <td style="text-align:right;"> 1.81e+07 </td>
   <td style="text-align:right;"> 12163 </td>
   <td style="text-align:right;"> 0.964 </td>
   <td style="text-align:right;"> 223 </td>
   <td style="text-align:right;"> 226 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.987 </td>
   <td style="text-align:right;"> 0.984 </td>
   <td style="text-align:right;"> 6.21 </td>
   <td style="text-align:right;"> 2.28e+07 </td>
   <td style="text-align:right;"> 14243 </td>
   <td style="text-align:right;"> 0.954 </td>
   <td style="text-align:right;"> 226 </td>
   <td style="text-align:right;"> 229 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.987 </td>
   <td style="text-align:right;"> 0.984 </td>
   <td style="text-align:right;"> 6.90 </td>
   <td style="text-align:right;"> 3.01e+07 </td>
   <td style="text-align:right;"> 15780 </td>
   <td style="text-align:right;"> 0.939 </td>
   <td style="text-align:right;"> 227 </td>
   <td style="text-align:right;"> 230 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.986 </td>
   <td style="text-align:right;"> 0.983 </td>
   <td style="text-align:right;"> 7.66 </td>
   <td style="text-align:right;"> 3.28e+07 </td>
   <td style="text-align:right;"> 16227 </td>
   <td style="text-align:right;"> 0.934 </td>
   <td style="text-align:right;"> 227 </td>
   <td style="text-align:right;"> 231 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.985 </td>
   <td style="text-align:right;"> 0.982 </td>
   <td style="text-align:right;"> 8.97 </td>
   <td style="text-align:right;"> 1.30e+07 </td>
   <td style="text-align:right;"> 11104 </td>
   <td style="text-align:right;"> 0.974 </td>
   <td style="text-align:right;"> 229 </td>
   <td style="text-align:right;"> 232 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.985 </td>
   <td style="text-align:right;"> 0.982 </td>
   <td style="text-align:right;"> 9.00 </td>
   <td style="text-align:right;"> 1.63e+07 </td>
   <td style="text-align:right;"> 11801 </td>
   <td style="text-align:right;"> 0.967 </td>
   <td style="text-align:right;"> 229 </td>
   <td style="text-align:right;"> 232 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.985 </td>
   <td style="text-align:right;"> 0.981 </td>
   <td style="text-align:right;"> 9.41 </td>
   <td style="text-align:right;"> 1.78e+07 </td>
   <td style="text-align:right;"> 12296 </td>
   <td style="text-align:right;"> 0.964 </td>
   <td style="text-align:right;"> 229 </td>
   <td style="text-align:right;"> 232 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.978 </td>
   <td style="text-align:right;"> 0.974 </td>
   <td style="text-align:right;"> 16.80 </td>
   <td style="text-align:right;"> 3.44e+07 </td>
   <td style="text-align:right;"> 18046 </td>
   <td style="text-align:right;"> 0.930 </td>
   <td style="text-align:right;"> 235 </td>
   <td style="text-align:right;"> 238 </td>
  </tr>
<tr>
<td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.952 </td>
   <td style="text-align:right;"> 0.941 </td>
   <td style="text-align:right;"> 48.28 </td>
   <td style="text-align:right;"> 1.07e+08 </td>
   <td style="text-align:right;"> 26242 </td>
   <td style="text-align:right;"> 0.784 </td>
   <td style="text-align:right;"> 248 </td>
   <td style="text-align:right;"> 252 </td>
  </tr>
<tr>
<td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.991 </td>
   <td style="text-align:right;"> 0.988 </td>
   <td style="text-align:right;"> 4.03 </td>
   <td style="text-align:right;"> 2.86e+07 </td>
   <td style="text-align:right;"> 14606 </td>
   <td style="text-align:right;"> 0.942 </td>
   <td style="text-align:right;"> 222 </td>
   <td style="text-align:right;"> 227 </td>
  </tr>
<tr>
<td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.991 </td>
   <td style="text-align:right;"> 0.987 </td>
   <td style="text-align:right;"> 4.26 </td>
   <td style="text-align:right;"> 3.03e+07 </td>
   <td style="text-align:right;"> 14992 </td>
   <td style="text-align:right;"> 0.939 </td>
   <td style="text-align:right;"> 223 </td>
   <td style="text-align:right;"> 227 </td>
  </tr>
<tr>
<td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.991 </td>
   <td style="text-align:right;"> 0.987 </td>
   <td style="text-align:right;"> 4.35 </td>
   <td style="text-align:right;"> 2.25e+07 </td>
   <td style="text-align:right;"> 13364 </td>
   <td style="text-align:right;"> 0.955 </td>
   <td style="text-align:right;"> 223 </td>
   <td style="text-align:right;"> 227 </td>
  </tr>
<tr>
<td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0.988 </td>
   <td style="text-align:right;"> 0.984 </td>
   <td style="text-align:right;"> 7.54 </td>
   <td style="text-align:right;"> 3.77e+07 </td>
   <td style="text-align:right;"> 17952 </td>
   <td style="text-align:right;"> 0.924 </td>
   <td style="text-align:right;"> 227 </td>
   <td style="text-align:right;"> 231 </td>
  </tr>
<tr>
<td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.985 </td>
   <td style="text-align:right;"> 0.980 </td>
   <td style="text-align:right;"> 10.92 </td>
   <td style="text-align:right;"> 1.86e+07 </td>
   <td style="text-align:right;"> 12773 </td>
   <td style="text-align:right;"> 0.962 </td>
   <td style="text-align:right;"> 231 </td>
   <td style="text-align:right;"> 235 </td>
  </tr>
<tr>
<td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.991 </td>
   <td style="text-align:right;"> 0.987 </td>
   <td style="text-align:right;"> 6.00 </td>
   <td style="text-align:right;"> 3.22e+07 </td>
   <td style="text-align:right;"> 16025 </td>
   <td style="text-align:right;"> 0.935 </td>
   <td style="text-align:right;"> 224 </td>
   <td style="text-align:right;"> 229 </td>
  </tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</section><section id="r-lab-best-subset-selection-1" class="slide level2"><h2>
<span class="pink">R Lab</span> Best Subset Selection</h2>
<p>Scale Cp, AIC, BIC to <span class="math inline">\([0, 1]\)</span>.</p>

<img data-src="./images/15-var-select/unnamed-chunk-17-1.png" style="width:72.0%" class="r-stretch quarto-figure-center"></section><section id="selection-methods-forward-selection" class="slide level2"><h2>Selection Methods: Forward Selection</h2>
<ul>
<li>Begins with <strong>no regressors</strong>.</li>
<li>Insert regressors into the model <strong>one at a time</strong>.</li>
</ul>
<div class="fragment">
<ul>
<li>The first regressor selected, <span class="math inline">\(x_1\)</span>, is the one producing the <strong>largest <span class="math inline">\(R^2\)</span></strong> of any single regressor. It is the one with
<ul>
<li>the <strong>highest correlation</strong> with the response.</li>
<li>the <strong>largest <span class="math inline">\(F_{test}\)</span></strong> and <span class="math inline">\(F_{test} &gt; F_{IN}(\alpha, 1, n-2)\)</span>, where <span class="math inline">\(F_{IN}\)</span> is the pre-specified <span class="math inline">\(F\)</span> threshold.</li>
</ul>
</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>The second regressor <span class="math inline">\(x_2\)</span> produces the <strong>largest increase in <span class="math inline">\(R^2\)</span> in the presence of <span class="math inline">\(x_1\)</span></strong>. It is the one with
<ul>
<li>the <strong>largest partial correlation</strong> with the response.</li>
<li>the <strong>largest partial <span class="math inline">\(F_{test} = \frac{SS_R(x_2|x_1)}{MS_{res}(x_1, x_2)}\)</span></strong> and <span class="math inline">\(F_{test} &gt; F_{IN}(\alpha, 1, n-3)\)</span>
</li>
</ul>
</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>The process terminates when
<ul>
<li>partial <span class="math inline">\(F_{test} &lt;F_{IN}(\alpha, 1, n-p)\)</span>, or</li>
<li>the last candidate regressor is added to the model.</li>
</ul>
</li>
</ul>
<aside class="notes"><p><span class="math inline">\(F_{test} &gt; F_{\alpha, 1, n-2}\)</span> <span class="math inline">\(F_{test} = \frac{SS_R(x_2|x_1)}{MS_{res}(x_1, x_2)}&gt; F_{\alpha, 1, n-2}\)</span> Once a regressor has been added, it cannot be removed at a later step. - Begins with <strong>no regressors</strong> in the model other than the intercept. - Insert regressors into the model <strong>one at a time</strong>. - The first regressor selected to be entered into the model, say <span class="math inline">\(x_1\)</span>, is the one that produces the <strong>largest <span class="math inline">\(R^2\)</span></strong> of any single regressor. + the one with the <strong>highest correlation</strong> with the response. + the one with the <strong>largest <span class="math inline">\(F_{test}\)</span></strong> and <span class="math inline">\(F_{test} &gt; F_{IN}\)</span> - The second regressor examined is the one, say <span class="math inline">\(x_2\)</span>, that produces the <strong>largest increase in <span class="math inline">\(R^2\)</span> in the presence of <span class="math inline">\(x_1\)</span></strong>. + the one with the <strong>largest partial correlation</strong> with the response. + the one with the <strong>largest <span class="math inline">\(F_{test} = \frac{SS_R(x_2|x_1)}{MS_{res}(x_1, x_2)}\)</span></strong> and <span class="math inline">\(F_{test} &gt; F_{IN}\)</span> - The process terminates either when the partial <span class="math inline">\(F\)</span> statistic at a particular step does not exceed <span class="math inline">\(F_{IN}\)</span> or when the last candidate regressor is added to the model.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="r-lab-forward-selection-ols_step_forward_p" class="slide level2"><h2>
<span class="pink">R Lab</span> Forward Selection <code>ols_step_forward_p()</code>
</h2>
<ul>
<li>The default threshold compared with the <span class="math inline">\(p\)</span>-value <span class="math inline">\(=P(F_{1, n-p} &gt; F_{test})\)</span> is 0.3.</li>
<li>If <span class="math inline">\(p\)</span>-value &lt; 0.3, the regressor is entered.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>(olsrr_for <span class="ot">&lt;-</span> olsrr<span class="sc">::</span><span class="fu">ols_step_forward_p</span>(lm_full, <span class="at">penter =</span> <span class="fl">0.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                             Selection Summary                              
---------------------------------------------------------------------------
        Variable                  Adj.                                         
Step    Entered     R-Square    R-Square     C(p)        AIC         RMSE      
---------------------------------------------------------------------------
   1    x3            0.9722      0.9703    20.3812    285.5158    957.8556    
   2    x2            0.9867      0.9848     4.9416    274.9519    685.1685    
   3    x5            0.9901      0.9878     2.9177    272.0064    614.7794    
---------------------------------------------------------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># names(olsrr_for)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="r-lab-forward-selection-ols_step_forward_p-1" class="slide level2"><h2>
<span class="pink">R Lab</span> Forward Selection <code>ols_step_forward_p()</code>
</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>olsrr_for<span class="sc">$</span>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = paste(response, "~", paste(preds, collapse = " + ")), 
    data = l)

Coefficients:
(Intercept)           x3           x2           x5  
   1523.389        0.978        0.053     -320.951  </code></pre>
</div>
</div>
<ul>
<li>
<code>progress = TRUE</code>, <code>details = TRUE</code> for detailed selection progress.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>olsrr<span class="sc">::</span><span class="fu">ols_step_forward_p</span>(lm_full, <span class="at">penter =</span> <span class="fl">0.3</span>, <span class="at">progress =</span> <span class="cn">TRUE</span>, <span class="at">details =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="selection-methods-stepwise-regression" class="slide level2"><h2>Selection Methods: Stepwise Regression</h2>
<ul>
<li>This procedure is a <em>modification of forward selection.</em>
</li>
<li>At each step, all regressors put into the model are reassessed via their partial <span class="math inline">\(F\)</span> statistic.</li>
<li>A regressor added at an earlier step may now be redundant because of the relationships between it and regressors now in the equation.</li>
<li>If the partial <span class="math inline">\(F_{test} &lt; F_{OUT}\)</span>, the variable will be removed.</li>
<li>The method requires both an <span class="math inline">\(F_{IN}\)</span> and <span class="math inline">\(F_{OUT}\)</span>.</li>
</ul>
<aside class="notes"><p>it becomes insignificant with the addition of other variables to the model.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="r-lab-stepwise-regression-ols_step_both_p" class="slide level2"><h2>
<span class="pink">R Lab</span> Stepwise Regression <code>ols_step_both_p()</code>
</h2>
<ul>
<li>If <span class="math inline">\(p\)</span>-value &lt; pent = 0.1, the regressor is entered.</li>
<li>After refitting, the regressor is removed if <span class="math inline">\(p\)</span>-value &gt; prem = 0.3.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>(olsrr_both <span class="ot">&lt;-</span> olsrr<span class="sc">::</span><span class="fu">ols_step_both_p</span>(lm_full, <span class="at">pent =</span> <span class="fl">0.1</span>, <span class="at">prem =</span> <span class="fl">0.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                              Stepwise Selection Summary                                
---------------------------------------------------------------------------------------
                     Added/                   Adj.                                         
Step    Variable    Removed     R-Square    R-Square     C(p)        AIC         RMSE      
---------------------------------------------------------------------------------------
   1       x3       addition       0.972       0.970    20.3810    285.5158    957.8556    
   2       x2       addition       0.987       0.985     4.9420    274.9519    685.1685    
   3       x5       addition       0.990       0.988     2.9180    272.0064    614.7794    
---------------------------------------------------------------------------------------</code></pre>
</div>
</div>
</section><section id="comments-on-stepwise-type-procedures" class="slide level2"><h2>Comments on Stepwise-Type Procedures</h2>
<ul>
<li>There is a <strong>backward elimination</strong> stepwise-type procedure
<ul>
<li>Begin with the model with all <span class="math inline">\(M\)</span> candidate regressors.</li>
<li>Remove regressors from the model <strong>one at a time</strong>.</li>
<li><code><a href="https://olsrr.rsquaredacademy.com/reference/ols_step_backward_p.html">olsrr::ols_step_backward_p()</a></code></li>
<li>Check <a href="https://olsrr.rsquaredacademy.com/articles/variable_selection.html#best-subset-regression">Variable Selection Methods</a>
</li>
</ul>
</li>
</ul>
<div class="fragment">
<ul>
<li>One can select models/variables based on other metrics such as AIC
<ul>
<li><code><a href="https://olsrr.rsquaredacademy.com/reference/ols_step_forward_aic.html">olsrr::ols_step_forward_aic()</a></code></li>
<li><code><a href="https://olsrr.rsquaredacademy.com/reference/ols_step_both_aic.html">olsrr::ols_step_both_aic()</a></code></li>
<li><code><a href="https://olsrr.rsquaredacademy.com/reference/ols_step_backward_aic.html">olsrr::ols_step_backward_aic()</a></code></li>
</ul>
</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><p>The order in which the regressors enter or leave the model does <em>not</em> imply an order of importance to the regressors.</p></li>
<li><p><em>No one model may be the “best”.</em></p></li>
<li><p>Different stepwise techniques could result in different models. <!-- - Inexperienced analysts may use the final model simply because the procedure spit it out. --></p></li>
</ul>
<aside class="notes"><ul>
<li>The order in which the regressors enter or leave the model does not imply an order of importance to the regressors.</li>
<li>This is in fact a general problem with the forward selection procedure. Once a regressor has been added, it cannot be removed at a later step.</li>
<li>forward selection tends to agree with all possible regressions for small subset sizes but not for large ones</li>
<li>backward elimination tends to agree with all possible regressions for large subset sizes but not for small ones.</li>
<li>the most common being that none of the procedures generally guarantees that the best subset regression model of any size will be identified.</li>
<li>there is one best subset model, but that there are several equally good ones.</li>
</ul>
<p>set F IN = F OUT = 4, as this corresponds roughly to the upper 5% point of the F distribution Bendel and Afi fi [ 1974 ] recommend α = 0.25 for forward selection. F IN of between 1.3 and 2.</p>
<p>Kennedy and Bancroft [ 1971] suggest α = 0.25 for forward selection and recommend α = 0.10 for backward elimi</p>
<ul>
<li>STRATEGY FOR VARIABLE SELECTION AND MODEL BUILDING the PRESS statistic tends to recommend smaller models than Mallow’s Cp, which in turn tends to recommend smaller models than the adjusted R2 .</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/e/e8/Marquette_Golden_Eagles_logo.svg" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://math4780-f23.github.io/website/">math4780-f23.github.io/website</a></p>
</div>
</div>
</section></section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="../site_libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="../site_libs/revealjs/plugin/multiplex/socket.io.js"></script><script src="../site_libs/revealjs/plugin/multiplex/multiplex.js"></script><script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script><script src="../site_libs/revealjs/plugin/notes/notes.js"></script><script src="../site_libs/revealjs/plugin/search/search.js"></script><script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script><script src="../site_libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'multiplex': {"secret":null,"id":"64fc9b20cfe656a2","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1800,

        height: 1000,

        // Factor of the display size that should remain empty around the content
        margin: 5.0e-2,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>
<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">
<meta name="author" content="Dr.&nbsp;Cheng-Han Yu   Department of Mathematical and Statistical Sciences   Marquette University">
<title>MATH 4780 - Fall 2023 - Collinearity</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
<link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css" id="theme">
<link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="MATH 4780 - Fall 2023 - Collinearity">
<meta property="og:description" content="MATH 4780 / MSSC 5780 Regression Analysis">
<meta property="og:site-name" content="MATH 4780 - Fall 2023">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#447099" class="quarto-title-block center"><h1 class="title">Collinearity</h1>
  <p class="subtitle">MATH 4780 / MSSC 5780 Regression Analysis</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Cheng-Han Yu <br> Department of Mathematical and Statistical Sciences <br> Marquette University 
</div>
</div>
</div>

</section><section><section id="collinearity" class="title-slide slide level1 center"><h1>Collinearity</h1>
<h2>
Meaning
</h2>
<h2>
Sources
</h2>
<h2>
Effects
</h2>
<h2>
Diagnostics
</h2>
<h2>
Solutions
</h2>
</section><section id="what-is-collinearity" class="slide level2"><h2>What is Collinearity</h2>
<ul>
<li>
<strong>Collinearity</strong> refers to the situation in which <strong>two or more predictors are closely related to one another</strong>.</li>
<li>
<code>limit</code> and <code>age</code> appear to have no obvious relationship, which is good!</li>
<li>
<code>limit</code> and <code>rating</code> are highly correlated, and they are said to be <em>collinear</em>.</li>
</ul>

<img data-src="./images/14-collinearity/unnamed-chunk-2-1.png" style="width:65.0%" class="r-stretch quarto-figure-center"><aside class="notes"><ul>
<li>Collinearity is a fundamental problem with the data rather than model specification.</li>
<li>There is usually no satisfactory solution for a true collinearity problem.</li>
<li>Collinearity means some regressors in your model are highly correlated.</li>
<li>We want to have regressors that are <strong>NOT <em>moving with each other</em></strong>.</li>
<li>Ideally we desire to have <strong>orthogonal</strong> regressors.</li>
<li>The intuition is, we hope predictors can explain the variation of <span class="math inline">\(y\)</span>, right? That’s why we put these predictors in the model.</li>
<li>And ideally we hope each predictor can explain a part of variation of <span class="math inline">\(y\)</span> that can only be explained by that predictor and cannot be explained by any other predictors.</li>
<li>This kind of partition can be done if all the predictors are orthogonal.</li>
<li>If x1 and x2 are highly correlated, meaning that they are moving together, then the two predictors are gonna explain a large part of the same variation of of <span class="math inline">\(y\)</span>.</li>
<li>Think about it. If x1 and y are correlated in some way, and x1 and x2 are highly correlated, it means that x2 and y are going to be correlated in same way as x1 and y.</li>
<li>So we actually use two predictors to explain the same variation of <span class="math inline">\(y\)</span>, which is redundant.</li>
<li>The model will be confused and may not be able to understand this explained variation is due to x1 or due to x2.</li>
<li>Later, we’ll see why we don’t want the predictors to be correlated.</li>
<li>There are lots of bad effects on our regression model.</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="sources-of-collinearity" class="slide level2"><h2>Sources of Collinearity</h2>
<p>Four primary sources</p>
<ul>
<li>The data collection method employed</li>
<li>Constraints on the model or in the population</li>
<li>Model specification</li>
<li>A model with <span class="math inline">\(p&gt;n\)</span>
</li>
</ul>
<aside class="notes"><ul>
<li>Let’s see what causes Collinearity. Here are 4 sources of Collinearity.</li>
<li>The data collection method employed: the way we collect our data may cause the predictors to be moving together. We need to be more careful, and see if we can collect our data in another way, so that the correlation between predictors can be alleviated or weakened.</li>
<li>Constraints on the model or in the population: If two predictors are correlated in nature, then it is unavoidable to have Collinearity, and if we want to keep the two predictors in our model, we should consider other methods other than OLS.</li>
<li>Model specification: Polynomial regression.</li>
<li>A <span class="math inline">\(p&gt;n\)</span> model</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="data-collection" class="slide level2"><h2>Data Collection</h2>
<ul>
<li>Collinearity occurs when only a subspace of the entire sample space has been explored.</li>
<li>May be able to reduce this collinearity through the sampling technique used.</li>
<li>
<em>There is no physical reason why you can’t sample in that area</em>.</li>
</ul>

<img data-src="./images/14-collinearity/unnamed-chunk-3-1.png" style="width:55.0%" class="r-stretch quarto-figure-center"></section><section id="constraints" class="slide level2"><h2>Constraints</h2>
<ul>
<li>Physical constraints are present, and the collinearity will exist regardless of collection method.</li>
</ul>

<img data-src="./images/14-collinearity/unnamed-chunk-4-1.png" style="width:65.0%" class="r-stretch quarto-figure-center"></section><section id="model-specification" class="slide level2"><h2>Model Specification</h2>
<ul>
<li>Polynomial terms can cause ill-conditioning in <span class="math inline">\({\bf X'X}\)</span>.</li>
<li>As the order of the model increases, <span class="math inline">\({\bf X'X}\)</span> matrix inversion will become inaccurate, and error can be introduced into the parameter estimates.</li>
<li>If range on a regressor variable is small, adding an <span class="math inline">\(x^2\)</span> term can result in significant collinearity.</li>
</ul>
<aside class="notes"><p><span class="math inline">\(x\)</span> and <span class="math inline">\(x^2\)</span> are highly (linearly correlated) - Polynomial terms can cause ill-conditioning (a sign of Collinearity) in the <span class="math inline">\(({\bf X'X})\)</span> matrix. - As the order of the model increases, <span class="math inline">\(({\bf X'X})\)</span> matrix inversion will become more inaccurate, and error can be introduced into the parameter estimates - If range on a regressor variable is small, adding <span class="math inline">\(x^2\)</span> term can result in significant Collinearity.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="pn-model" class="slide level2"><h2>
<span class="math inline">\(p&gt;n\)</span> Model</h2>
<ul>
<li>More regressor variables than observations.</li>
<li>The best way to counter this is to remove/reconstruct regressor variables.
<ul>
<li>Principal Component Regression</li>
<li>Variable Selection (Next Topic)</li>
</ul>
</li>
</ul></section><section id="effect-of-collinearity" class="slide level2"><h2>Effect of Collinearity</h2>
<ol type="1">
<li>👉 <strong>Large variances and covariances</strong> for the LSE <span class="math inline">\(b_j\)</span>s.</li>
</ol>
<!-- $$({\bf X}_2'{\bf X}_2)^{-1} = \begin{bmatrix} 63.94 & -63.44 \\ -63.44 & 63.94 \end{bmatrix}$$  --><ol start="2" type="1">
<li>👉 Tends to produce LSE <span class="math inline">\(b_j\)</span> that are <strong>too large in absolute value</strong>. Therefore, the vector <span class="math inline">\({\bf b}\)</span>, on average, is much longer than the vector <span class="math inline">\(\boldsymbol \beta\)</span>.</li>
</ol>
<div class="alert">
<ul>
<li>Large variances and large magnitude of coefficients lead to <strong>instable</strong> and <strong>wrong signed</strong> coefficients.</li>
<li>Poor coefficients do not necessarily imply bad fit or poor prediction.</li>
<li>The predictions should be confined to the <span class="math inline">\(x\)</span> space where the collinearity holds approximately.</li>
<li>Collinearity causes very poor <em>extrapolated</em> prediction.</li>
</ul>
</div>
<aside class="notes"><ul>
<li>The squared distance from <span class="math inline">\({\bf b}\)</span> to <span class="math inline">\(\bsbeta\)</span> is <span class="math inline">\(D^2 = \sum_{j=1}^k(b_j - \beta_j)^2\)</span>.</li>
<li>The <em>expected</em> squared distance is <span class="math display">\[E(D^2) = E\left(\sum_{j=1}^k(b_j - \beta_j)^2 \right) = \sum_{j=1}^kE\left[(b_j - \beta_j)^2\right] = \sum_{j=1}^k\mathrm{Var}(b_j) = \sigma^2 \mathrm{tr}\left[({\bf X'X})^{-1}\right]\]</span>
</li>
<li>Strong Collinearity between <span class="math inline">\(x\)</span>’s results in</li>
<li>the trace of a matrix (Tr) is the sum of the diagonal elements.</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="perfectly-correlated-regressors" class="slide level2"><h2>Perfectly Correlated Regressors</h2>
<ul>
<li><p>Suppose the true population regression equation is <span class="math inline">\(y = 3 + 4x\)</span>.</p></li>
<li><p>Suppose we try estimating that equation using perfected correlated variables <span class="math inline">\(x\)</span> and <span class="math inline">\(z = x/10\)</span>.</p></li>
</ul>
<p><span class="math display">\[
\begin{aligned}\hat{y}&amp;= \hat{\beta}_0 + \hat{\beta}_1x  + \hat{\beta}_2z\\
&amp;= \hat{\beta}_0 + \hat{\beta}_1x  + \hat{\beta}_2\frac{x}{10}\\
&amp;= \hat{\beta}_0 + \bigg(\hat{\beta}_1 + \frac{\hat{\beta}_2}{10}\bigg)x
\end{aligned}
\]</span> <!-- $$\hat{y} = \hat{\beta}_0 + \bigg(\hat{\beta}_1 + \frac{\hat{\beta}_2}{10}\bigg)x$$ --></p>
<div class="fragment">
<ul>
<li><p>Can set <span class="math inline">\(\hat{\beta}_1\)</span> and <span class="math inline">\(\hat{\beta}_2\)</span> to any two numbers such that <span class="math inline">\(\hat{\beta}_1 + \frac{\hat{\beta}_2}{10} = 4\)</span>.</p></li>
<li><p>Unable to choose the “best” combination of <span class="math inline">\(\hat{\beta}_1\)</span> and <span class="math inline">\(\hat{\beta}_2\)</span>.</p></li>
</ul>
<aside class="notes"><ul>
<li>Collinearity is a fundamental problem with the data rather than model specification.</li>
<li>There is usually no satisfactory solution for a true collinearity problem.</li>
<li>Collinearity means some regressors in your model are highly correlated.</li>
<li>We want to have regressors that are <strong>NOT <em>moving with each other</em></strong>.</li>
<li>Ideally we desire to have <strong>orthogonal</strong> regressors.</li>
<li>The intuition is, we hope predictors can explain the variation of <span class="math inline">\(y\)</span>, right? That’s why we put these predictors in the model.</li>
<li>And ideally we hope each predictor can explain a part of variation of <span class="math inline">\(y\)</span> that can only be explained by that predictor and cannot be explained by any other predictors.</li>
<li>This kind of partition can be done if all the predictors are orthogonal.</li>
<li>If x1 and x2 are highly correlated, meaning that they are moving together, then the two predictors are gonna explain a large part of the same variation of of <span class="math inline">\(y\)</span>.</li>
<li>Think about it. If x1 and y are correlated in some way, and x1 and x2 are highly correlated, it means that x2 and y are going to be correlated in same way as x1 and y.</li>
<li>So we actually use two predictors to explain the same variation of <span class="math inline">\(y\)</span>, which is redundant.</li>
<li>The model will be confused and may not be able to understand this explained variation is due to x1 or due to x2.</li>
<li>Later, we’ll see why we don’t want the predictors to be correlated.</li>
<li>There are lots of bad effects on our regression model.</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="collinearity-diagnostics" class="slide level2"><h2>Collinearity Diagnostics</h2>
<p>Ideal characteristics of a collinearity diagnostic:</p>
<ul>
<li>Correctly indicate if collinearity is present</li>
<li>How severe the problem is</li>
<li>Provide insight as to which regressors are causing the problem</li>
</ul></section><section id="examination-of-the-correlation-matrix-of-xs" class="slide level2"><h2>Examination of the Correlation Matrix of <span class="math inline">\(x\)</span>s</h2>
<ul>
<li><p>After <em>unit length scaling</em><sup>1</sup>, <span class="math inline">\({\bf X'X} = \left[r_{ij}\right]_{k\times k}\)</span> is the <em>correlation</em> matrix of <span class="math inline">\(x\)</span>s denoted as <span class="math inline">\({\bf \Sigma}\)</span>. <sup>2</sup> For example, <span class="math display">\[{\bf X'X} = \begin{bmatrix} 1 &amp; 0.992 \\ 0.992 &amp; 1 \end{bmatrix}\]</span></p></li>
<li><p><span class="math inline">\(r_{ij}\)</span> is the <strong>pairwise</strong> correlation between <span class="math inline">\(x_i\)</span> and <span class="math inline">\(x_j\)</span>.</p></li>
<li><p>Large <span class="math inline">\(|r_{ij}|\)</span> is an indication of collinearity.</p></li>
<li><p>When <strong>more than two</strong> regressors are involved in collinearity, there may be instances when <em>collinearity is present, but the pairwise correlations are not large.</em></p></li>
<li><p>Inspecting <span class="math inline">\(r_{ij}\)</span> is not sufficient for detecting more complex collinearity.</p></li>
</ul>
<aside class="notes"><p>After unit length scaling, <span class="math inline">\({\bf X'X}\)</span> is the correlation matrix of regressors. - If we scale and center the regressors, we have the correlation matrix. <span class="math display">\[{\bf X'X} = \begin{bmatrix} 1 &amp; 0.992 \\ 0.992 &amp; 1 \end{bmatrix}\]</span> - The off diagonal elements of the centered and scaled <span class="math inline">\({\bf X'X}\)</span> matrix are the <strong>pairwise</strong> correlations between <span class="math inline">\(x_i\)</span> and <span class="math inline">\(x_j\)</span>, denoted as <span class="math inline">\(r_{ij}\)</span>. For example, <span class="math inline">\(r_{12} = 0.992\)</span>. - If <span class="math inline">\(|r_{ij}| \approx 1\)</span>, there is an indication of Collinearity. But, the opposite does not always hold. - When there are <em>more than two regressors</em>, there may be instances when Collinearity is present, but the pairwise correlations do not indicate a problem. (Webster, Gunst, and Mason [1974] Table 9.4) - Inspection of the <span class="math inline">\(r_{ij}\)</span> is not sufficient for detecting anything more complex than <em>pairwise</em> Collinearity.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside><aside><ol class="aside-footnotes"><li id="fn1"><p><span class="math inline">\(\tilde{x}_{ij} = \frac{x_{ij} - \overline{x}_j}{\sqrt{\sum_{i=1}^n (x_{ij} - \overline{x}_j)^2}}\)</span> for <span class="math inline">\(~~i = 1, 2, \dots, n\)</span>, <span class="math inline">\(~~ j = 1, 2, \dots, k\)</span>.</p></li><li id="fn2"><p>The term <em>correlation</em> is a bit of misnomer. The regressors are not random variables. The correlation coefficient <span class="math inline">\(r_{ij}\)</span> does measure linear dependency between <em><span class="math inline">\(x_i\)</span> and <span class="math inline">\(x_j\)</span> in the data</em>.</p></li></ol></aside></section><section id="variance-inflation-factors" class="slide level2"><h2>Variance Inflation Factors</h2>
<!-- - $\small ({\bf X}_1'{\bf X}_1)^{-1} = \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}$ $\quad \small ({\bf X}_2'{\bf X}_2)^{-1} = \begin{bmatrix} 63.94 & -63.44 \\ -63.44 & 63.94 \end{bmatrix}$ -->
<ul>
<li><p>The diagonals of <span class="math inline">\({\bf \Sigma}^{-1} = {\bf C}\)</span> in correlation form are called <strong>variance inflation factors</strong> <span class="math display">\[\text{VIF}_j = {\bf C}_{jj}\]</span></p></li>
<li><p>Example: <span class="math display">\[{\bf \Sigma} = \begin{bmatrix} 1 &amp; 0.992 \\ 0.992 &amp; 1 \end{bmatrix}; \quad {\bf \Sigma}^{-1} = \begin{bmatrix} 62.8 &amp; -62.2 \\ -62.2 &amp; 62.8 \end{bmatrix}\]</span> and <span class="math inline">\(\text{VIF}_1 = 62.8\)</span>.</p></li>
</ul>
<div class="alert">
<ul>
<li>The collinearity produces an inflation in the variances of the estimated coefficients, an increase in <em>60-fold</em> over the <em>ideal case</em> when the two regressors are orthogonal.</li>
<li>VIFs <span class="math inline">\(&gt; 10\)</span> are considered significant.</li>
</ul>
</div>
</section><section id="variance-inflation-factors-1" class="slide level2"><h2>Variance Inflation Factors</h2>
<p><span class="math display">\[\text{VIF}_j = \frac{1}{1 - R^2_{X_j | X_{-j}}}\]</span> where <span class="math inline">\(R^2_{X_j | X_{-j}}\)</span> is the coefficient of determination obtained when <span class="math inline">\(x_j\)</span> is regressed on the other regressors <span class="math inline">\(x_i, i \ne j\)</span>.</p>
<p><span class="math display">\[\mathrm{Var}(b_j) = \frac{s^2}{\sum_{i=1}^n(x_{ij} - \bar{x}_j)^2} \times \text{VIF}_j\]</span></p>
<ul>
<li><p><span class="math inline">\(\text{VIF}_j\)</span> measures the <strong>combined</strong> effect of the dependencies among the regressors on the variance of <span class="math inline">\(b_j\)</span>.</p></li>
<li><p>If <span class="math inline">\(x_j\)</span> is <em>near linearly dependent</em> on some subset of the remaining regressors, <span class="math inline">\({\bf C}_{jj}\)</span> is large.</p></li>
</ul>
<div class="question">
<p>Remember what does linear (in)dependence mean?</p>
</div>
<aside class="notes"><p><span class="math display">\[\text{VIF}_j = {\bf C}_{jj} = \frac{1}{1 - R^2_j}\]</span> + <span class="math inline">\(R_j^2\)</span>: the coefficient of determination obtained when <span class="math inline">\(x_j\)</span> is regressed on the remaining regressors <span class="math inline">\(x_i, i \ne j\)</span>. - If <span class="math inline">\(x_j\)</span> can be explained a lot from other regressors, <span class="math inline">\(x_j\)</span> is probably unnecessary in the regression model when all others are in the model. When it is in the model, the model cannot understand what the real effect the predictor can provide, and therefore its coefficient has a large variance. - The regressors that have high VIFs probably have poorly estimated coefficients. - The Collinearity produces an inflation in the variances of the estimated coefficients, an increase in <em>60-fold</em> over the <em>ideal case</em> when the two regressors are orthogonal. - Since the variance of the j th regression coefficients is C jj σ 2 , we can view C jj as the factor by which the variance of ˆβj is increased due to near - linear dependences among the regressors.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="r-lab-hospital-manpower-data" class="slide level2"><h2>
<span class="pink">R Lab</span> <a href="./data/manpower.csv">Hospital Manpower</a> Data</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1" data-code-line-numbers="false"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">manpower</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource my_class600 number-lines code-with-copy"><code class="sourceCode"><span id="cb2-1"><a href="#cb2-1"></a>       y  x1    x2    x3    x4   x5</span>
<span id="cb2-2"><a href="#cb2-2"></a>1    567  16  2463   473  18.0  4.5</span>
<span id="cb2-3"><a href="#cb2-3"></a>2    697  44  2048  1340   9.5  6.9</span>
<span id="cb2-4"><a href="#cb2-4"></a>3   1033  20  3940   620  12.8  4.3</span>
<span id="cb2-5"><a href="#cb2-5"></a>4   1604  19  6505   568  36.7  3.9</span>
<span id="cb2-6"><a href="#cb2-6"></a>5   1611  49  5723  1498  35.7  5.5</span>
<span id="cb2-7"><a href="#cb2-7"></a>6   1613  45 11520  1366  24.0  4.6</span>
<span id="cb2-8"><a href="#cb2-8"></a>7   1854  55  5779  1687  43.3  5.6</span>
<span id="cb2-9"><a href="#cb2-9"></a>8   2161  59  5969  1640  46.7  5.2</span>
<span id="cb2-10"><a href="#cb2-10"></a>9   2306  94  8461  2872  78.7  6.2</span>
<span id="cb2-11"><a href="#cb2-11"></a>10  3504 128 20106  3655 180.5  6.2</span>
<span id="cb2-12"><a href="#cb2-12"></a>11  3572  96 13313  2912  60.9  5.9</span>
<span id="cb2-13"><a href="#cb2-13"></a>12  3741 131 10771  3921 103.7  4.9</span>
<span id="cb2-14"><a href="#cb2-14"></a>13  4027 127 15543  3866 126.8  5.5</span>
<span id="cb2-15"><a href="#cb2-15"></a>14 10344 253 36194  7684 157.7  7.0</span>
<span id="cb2-16"><a href="#cb2-16"></a>15 11732 409 34703 12446 169.4 10.8</span>
<span id="cb2-17"><a href="#cb2-17"></a>16 15415 464 39204 14098 331.4  7.0</span>
<span id="cb2-18"><a href="#cb2-18"></a>17 18854 510 86533 15524 371.6  6.3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><span class="math inline">\(y\)</span>: Monthly man-hours</p>
<p><br></p>
<p><span class="math inline">\(x_1\)</span>: Average daily patient load</p>
<p><br></p>
<p><span class="math inline">\(x_2\)</span>: Monthly X-ray exposures</p>
<p><br></p>
<p><span class="math inline">\(x_3\)</span>: Monthly occupied bed days</p>
<p><br></p>
<p><span class="math inline">\(x_4\)</span>: Eligible population in the area / 1000</p>
<p><br></p>
<p><span class="math inline">\(x_5\)</span>: Average length of patients’ stay in days</p>
</div>
</div>
<div class="question">
<p>Do you expect to see positive or negative relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x_i\)</span>?</p>
</div>
</section><section id="r-lab-hospital-manpower---pairwise-dependence" class="slide level2"><h2>
<span class="pink">R Lab</span> Hospital Manpower - Pairwise Dependence</h2>

<img data-src="./images/14-collinearity/unnamed-chunk-6-1.png" style="width:80.0%" class="r-stretch quarto-figure-center"></section><section id="r-lab-hospital-manpower---model-fit" class="slide level2"><h2>
<span class="pink">R Lab</span> Hospital Manpower - Model Fit</h2>
<div class="cell" data-layout-align="center" data-output.lines="[10,11,12,13,14,15,16,20,21]">
<div class="sourceCode" id="cb3" data-code-line-numbers="false"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lm_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">manpower</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">summ_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_full</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>...
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) 1962.9482  1071.3617    1.83    0.094 .
x1           -15.8517    97.6530   -0.16    0.874  
x2             0.0559     0.0213    2.63    0.023 *
x3             1.5896     3.0921    0.51    0.617  
x4            -4.2187     7.1766   -0.59    0.569  
x5          -394.3141   209.6395   -1.88    0.087 .
Residual standard error: 642 on 11 degrees of freedom
Multiple R-squared:  0.991, Adjusted R-squared:  0.987 
...</code></pre>
</div>
</div>
<div class="question">
<p>Excellent fit. But any issues of the this fitted result?</p>
</div>
<div class="fragment">
<ul>
<li>The coefficients <span class="math inline">\(b_1\)</span>, <span class="math inline">\(b_4\)</span> and <span class="math inline">\(b_5\)</span> are <strong>negative.</strong>
</li>
<li>In the case of <span class="math inline">\(x_1\)</span>, an increase in patient load, when other <span class="math inline">\(x\)</span>’s are held constant, corresponds to a decrease in hospital manpower. (<strong>wrong sign</strong> due to large variance)</li>
</ul>
<aside class="notes"><ul>
<li>Even though the regression model fits the data quite well, the rather curious signs on the regression coefficients may be the result of the effect of Collinearity.</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section><section id="r-lab-hospital-manpower---vif" class="slide level2"><h2>
<span class="pink">R Lab</span> Hospital Manpower - VIF</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5" data-code-line-numbers="false"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">manpower</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">(</span><span class="va">Sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     x1   x2   x3   x4   x5
x1 1.00 0.91 1.00 0.94 0.67
x2 0.91 1.00 0.91 0.91 0.45
x3 1.00 0.91 1.00 0.93 0.67
x4 0.94 0.91 0.93 1.00 0.46
x5 0.67 0.45 0.67 0.46 1.00</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7" data-code-line-numbers="false"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">Sig</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      x1    x2    x3     x4    x5
x1  9598  11.9 -9247 -318.8 -93.9
x2    12   7.9   -18   -1.9   1.8
x3 -9247 -18.5  8933  294.4  83.4
x4  -319  -1.9   294   23.3   6.4
x5   -94   1.8    83    6.4   4.3</code></pre>
</div>
<div class="sourceCode" id="cb9" data-code-line-numbers="false"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## VIF </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">C</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    x1     x2     x3     x4     x5 
9597.6    7.9 8933.1   23.3    4.3 </code></pre>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11" data-code-line-numbers="false"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## put the fitted model in vif()</span></span>
<span><span class="op">(</span><span class="va">vif_all</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">lm_full</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    x1     x2     x3     x4     x5 
9597.6    7.9 8933.1   23.3    4.3 </code></pre>
</div>
</div>
<p><span class="math inline">\(x_1\)</span> <code>Average daily patient load</code> and <span class="math inline">\(x_3\)</span> <code>Monthly occupied bed days</code> are highly correlated.</p>
</div>
</section><section id="r-lab-hospital-manpower---confidence-interval" class="slide level2"><h2>
<span class="pink">R Lab</span> Hospital Manpower - Confidence Interval</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="./images/14-collinearity/unnamed-chunk-11-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Marginally, <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_3\)</span> vary a lot. The CI for <span class="math inline">\(\beta_1\)</span> and CI for <span class="math inline">\(\beta_3\)</span> both contain zero.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>    2.5 % 97.5 %
x1 -230.8  199.1
x3   -5.2    8.4</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="./images/14-collinearity/unnamed-chunk-13-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>But very confident that <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_3\)</span> cannot be both zero.</li>
</ul>
</div>
</div>
</div>
<aside class="notes"><ul>
<li>The model is quite not sure how much <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_3\)</span> affect <span class="math inline">\(y\)</span>.</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="r-lab-hospital-manpower---confidence-interval-1" class="slide level2"><h2>
<span class="pink">R Lab</span> Hospital Manpower - Confidence Interval</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="./images/14-collinearity/unnamed-chunk-14-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="./images/14-collinearity/unnamed-chunk-15-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>
<span class="math inline">\(x_4\)</span> and <span class="math inline">\(x_5\)</span> are not highly correlated pairwisely. <span class="math inline">\(r_{45} = 0.46\)</span>.</li>
<li>However, their CI is still inflated due to the collinearity effect of <em>other</em> variables.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>   2.5 % 97.5 %
x4   -20     12
x5  -856     67</code></pre>
</div>
</div>
<aside class="notes"><p>Don’t just look at the pairwise correlation</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="eigensystem-analysis-condition-indices" class="slide level2"><h2>Eigensystem Analysis: Condition Indices</h2>
<ul>
<li>The eigenvalues of <span class="math inline">\({\bf \Sigma}\)</span> (the correlation matrix of <span class="math inline">\(\bf X\)</span>), <span class="math inline">\(\lambda_1, \lambda_2, \dots, \lambda_k\)</span>, can measure collinearity.<br>
</li>
<li>If there are one or more near-linear dependencies, one or more of the <span class="math inline">\(\lambda_i\)</span>s will be (relatively) <em>small</em>. <!-- - **Condition number** of ${\bf X'X}$ is $\kappa = \frac{\lambda_{max}}{\lambda_{min}}$.  --> <!-- - $\kappa > 100$ implies collinearity. --> <!-- - $\kappa$ does not tell us *how many* regressors are involved. -->
</li>
<li>
<strong>Condition indices</strong> of <span class="math inline">\({\bf \Sigma}\)</span> are <span class="math inline">\(\kappa_j = \frac{\lambda_{max}}{\lambda_{j}}\)</span>.</li>
<li>The number of <span class="math inline">\(\kappa_j &gt; 1000\)</span> is a measure of the number of near-linear dependencies in <span class="math inline">\({\bf \Sigma}.\)</span>
</li>
</ul>
<aside class="notes"><ul>
<li>The eigenvalues of <span class="math inline">\({\bf X'X}\)</span>, <span class="math inline">\(\lambda_1, \lambda_2, \dots, \lambda_k\)</span>, can measure Collinearity.<br>
</li>
<li>If there are one or more near-linear dependencies in the data, one or more of the <span class="math inline">\(\lambda_i\)</span>s will be small.</li>
<li>
<strong>Condition number</strong> of <span class="math inline">\({\bf X'X}\)</span> is <span class="math inline">\(\kappa = \frac{\lambda_{max}}{\lambda_{min}}\)</span>.</li>
<li>
<span class="math inline">\(\kappa &gt; 100\)</span> implies Collinearity.</li>
<li>
<span class="math inline">\(\kappa\)</span> does not tell us <em>how many</em> regressors are involved.</li>
<li>
<strong>Condition indices</strong> of <span class="math inline">\({\bf X'X}\)</span> is <span class="math inline">\(\kappa_j = \frac{\lambda_{max}}{\lambda_{j}}\)</span>.</li>
<li>The number of <span class="math inline">\(\kappa_j &gt; 1000\)</span> is a measure of the number of near-linear dependencies in <span class="math inline">\({\bf X'X}.\)</span>
</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="r-lab-hospital-manpower---eigensystem-analysis" class="slide level2"><h2>
<span class="pink">R Lab</span> Hospital Manpower - Eigensystem Analysis</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15" data-code-line-numbers="false"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">eigen_Sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">Sig</span><span class="op">)</span></span>
<span><span class="co">## eigenvalues</span></span>
<span><span class="op">(</span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">eigen_Sig</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.2e+00 6.7e-01 9.5e-02 4.1e-02 5.4e-05</code></pre>
</div>
<div class="sourceCode" id="cb17" data-code-line-numbers="false"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Conditional indices</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span> <span class="op">/</span> <span class="va">lambda</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]     1.0     6.3    44.4   103.1 77769.7</code></pre>
</div>
</div>
<ul>
<li>
<span class="math inline">\(\lambda_5 \approx 0\)</span> and <span class="math inline">\(\kappa_5 \approx 77770\)</span>, indicating collinearity.</li>
</ul>
<div class="alert">
<p>Eigenvalues are listed in a decreasing order, <span class="math inline">\(\lambda_1 &gt; \lambda_2 &gt; \cdots &gt; \lambda_k\)</span>, and <span class="math inline">\(\lambda_5\)</span> is <em>not</em> the eigenvalue of <span class="math inline">\(x_5\)</span>.</p>
</div>
<aside class="notes"><div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]     [,2]  [,3]  [,4]    [,5]
[1,] -0.49 -0.00203 -0.17 -0.47  0.7195
[2,] -0.45 -0.33561  0.80  0.19  0.0012
[3,] -0.48 -0.00085 -0.15 -0.51 -0.6941
[4,] -0.46 -0.31080 -0.54  0.63 -0.0234
[5,] -0.33  0.88925  0.12  0.29 -0.0068</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 1 1 1</code></pre>
</div>
</div>
<p>There is one near linear dependency.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="eigensystem-analysis-eigendecomposition" class="slide level2"><h2>Eigensystem Analysis: Eigendecomposition</h2>
<ul>
<li>Eigendecomposition <span class="math display">\[{\bf \Sigma = V\boldsymbol \Lambda V'}\]</span>
<ul>
<li>
<span class="math inline">\(\boldsymbol \Lambda\)</span> is a <span class="math inline">\(k \times k\)</span> diagonal matrix whose elements are <span class="math inline">\(\lambda_j\)</span>.</li>
<li>
<span class="math inline">\({\bf V} = [{\bf v}_1 \quad {\bf v}_2 \quad \dots \quad {\bf v}_k]\)</span> is a <span class="math inline">\(k \times k\)</span> orthogonal matrix whose columns are the eigenvectors of <span class="math inline">\({\bf \Sigma}\)</span>.</li>
</ul>
</li>
<li>If <span class="math inline">\(\lambda_j \approx 0\)</span>, the associated <span class="math inline">\({\bf v}_j = (v_{1j}, v_{2j}, \dots, v_{kj})'\)</span> describes how (and what) regressors are linearly dependent: <span class="math display">\[\sum_{i=1}^kv_{ij}{\bf x}_i \cong \mathbf{0}\]</span>
</li>
</ul>
<!-- - $\sum_{i=1}^kc_i{\bf x}_i \cong \mathbf{0}$: The "weights" $c_i$ are the individual elements in the ${\bf v}_j$. --><aside class="notes"><ul>
<li>If <span class="math inline">\(\lambda_j \approx 0\)</span>, the associated <span class="math inline">\({\bf v}_j = (v_{1j}, v_{2j}, \dots, v_{kj})'\)</span> describes the nature of this linear dependence.</li>
<li>
<span class="math inline">\(\sum_{i=1}^kc_i{\bf x}_i \cong \mathbf{0}\)</span>: The “weights” <span class="math inline">\(c_i\)</span> are the individual elements in the <span class="math inline">\({\bf v}_j\)</span>.</li>
</ul><style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="r-lab-hospital-manpower---eigensystem-analysis-1" class="slide level2"><h2>
<span class="pink">R Lab</span> Hospital Manpower - Eigensystem Analysis</h2>
<div class="cell" data-layout-align="center">

</div>
<div class="columns">
<div class="column" style="width:65%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21" data-code-line-numbers="false"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## eigenvector matrix</span></span>
<span><span class="op">(</span><span class="va">V</span> <span class="op">&lt;-</span> <span class="va">eigen_Sig</span><span class="op">$</span><span class="va">vectors</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]     [,2]  [,3]  [,4]    [,5]
[1,] -0.49 -0.00203 -0.17 -0.47  0.7195
[2,] -0.45 -0.33561  0.80  0.19  0.0012
[3,] -0.48 -0.00085 -0.15 -0.51 -0.6941
[4,] -0.46 -0.31080 -0.54  0.63 -0.0234
[5,] -0.33  0.88925  0.12  0.29 -0.0068</code></pre>
</div>
</div>
<ul>
<li>
<span class="math inline">\({\bf X}{\bf v}_5 = \sum_{i=1}^5v_{i5}{\bf x}_i \approx {\bf 0}\)</span>.</li>
<li><span class="math inline">\(0.720 {\bf x}_1 + 0.001 {\bf x}_2 - 0.694 {\bf x}_3 - 0.023 {\bf x}_4 - 0.007 {\bf x}_5 \approx {\bf 0}\)</span></li>
<li>Highly correlated <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_3\)</span> causes collinearity.</li>
</ul>
<div class="cell" data-layout-align="center">

</div>
<div class="alert">
<ul>
<li>All <span class="math inline">\({\bf x}\)</span>s here are unit length scaled.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23" data-code-line-numbers="false"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">X_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">X</span>, <span class="fl">2</span>, <span class="va">unit_len_scale</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div><div class="column" style="width:35%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24" data-code-line-numbers="false"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">X_s</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">V</span><span class="op">[</span>, <span class="fl">5</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb25"><pre class="sourceCode numberSource my_class800 number-lines code-with-copy"><code class="sourceCode"><span id="cb25-1"><a href="#cb25-1"></a>          [,1]</span>
<span id="cb25-2"><a href="#cb25-2"></a> [1,] -0.00037</span>
<span id="cb25-3"><a href="#cb25-3"></a> [2,] -0.00144</span>
<span id="cb25-4"><a href="#cb25-4"></a> [3,]  0.00032</span>
<span id="cb25-5"><a href="#cb25-5"></a> [4,] -0.00058</span>
<span id="cb25-6"><a href="#cb25-6"></a> [5,] -0.00108</span>
<span id="cb25-7"><a href="#cb25-7"></a> [6,]  0.00047</span>
<span id="cb25-8"><a href="#cb25-8"></a> [7,] -0.00131</span>
<span id="cb25-9"><a href="#cb25-9"></a> [8,]  0.00492</span>
<span id="cb25-10"><a href="#cb25-10"></a> [9,] -0.00225</span>
<span id="cb25-11"><a href="#cb25-11"></a>[10,]  0.00230</span>
<span id="cb25-12"><a href="#cb25-12"></a>[11,] -0.00050</span>
<span id="cb25-13"><a href="#cb25-13"></a>[12,]  0.00209</span>
<span id="cb25-14"><a href="#cb25-14"></a>[13,] -0.00251</span>
<span id="cb25-15"><a href="#cb25-15"></a>[14,] -0.00016</span>
<span id="cb25-16"><a href="#cb25-16"></a>[15,]  0.00131</span>
<span id="cb25-17"><a href="#cb25-17"></a>[16,] -0.00098</span>
<span id="cb25-18"><a href="#cb25-18"></a>[17,] -0.00023</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<aside class="notes"><div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]  [,3]  [,4]    [,5]
[1,]  4.2 0.00 0.000 0.000 0.0e+00
[2,]  0.0 0.67 0.000 0.000 0.0e+00
[3,]  0.0 0.00 0.095 0.000 0.0e+00
[4,]  0.0 0.00 0.000 0.041 0.0e+00
[5,]  0.0 0.00 0.000 0.000 5.4e-05</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="do">## Orthogonal matrix</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="fu">round</span>(<span class="fu">t</span>(V)<span class="sc">%*%</span>V, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]    1    0    0    0    0
[2,]    0    1    0    0    0
[3,]    0    0    1    0    0
[4,]    0    0    0    1    0
[5,]    0    0    0    0    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="do">##  V(Lambda)V' = X'X</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>V <span class="sc">%*%</span> <span class="fu">diag</span>(lambda) <span class="sc">%*%</span> <span class="fu">t</span>(V)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,] 1.00 0.91 1.00 0.94 0.67
[2,] 0.91 1.00 0.91 0.91 0.45
[3,] 1.00 0.91 1.00 0.93 0.67
[4,] 0.94 0.91 0.93 1.00 0.46
[5,] 0.67 0.45 0.67 0.46 1.00</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="do">## near-zero vector</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>X_s<span class="sc">%*%</span>V[, <span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
 [1,] -0.00037
 [2,] -0.00144
 [3,]  0.00032
 [4,] -0.00058
 [5,] -0.00108
 [6,]  0.00047
 [7,] -0.00131
 [8,]  0.00492
 [9,] -0.00225
[10,]  0.00230
[11,] -0.00050
[12,]  0.00209
[13,] -0.00251
[14,] -0.00016
[15,]  0.00131
[16,] -0.00098
[17,] -0.00023</code></pre>
</div>
</div>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></section><section id="other-diagnostics" class="slide level2"><h2>Other Diagnostics</h2>
<p>Collinearity may exist if</p>
<ul>
<li><p>overall <span class="math inline">\(F\)</span>-test for regression is significant, but individual <span class="math inline">\(t\)</span>-tests are all non-significant.</p></li>
<li>
<p>the coefficient estimates are <strong>instable</strong></p>
<ul>
<li>adding or removing a regressor produces large changes in the estimates</li>
<li>deleting one or more observations results in large changes in the estimates</li>
<li>if the signs or magnitudes of the estimates are contrary to prior expectation</li>
</ul>
</li>
</ul></section><section id="r-lab-hospital-manpower---significance" class="slide level2"><h2>
<span class="pink">R Lab</span> Hospital Manpower - Significance</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb43" data-code-line-numbers="false"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_full</span><span class="op">$</span><span class="va">coefficients</span>  <span class="co">## t-test not significant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 1962.948    1.1e+03    1.83    0.094
x1           -15.852    9.8e+01   -0.16    0.874
x2             0.056    2.1e-02    2.63    0.023
x3             1.590    3.1e+00    0.51    0.617
x4            -4.219    7.2e+00   -0.59    0.569
x5          -394.314    2.1e+02   -1.88    0.087</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb45" data-code-line-numbers="false"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summ_full</span><span class="op">$</span><span class="va">fstatistic</span>  <span class="co">## F-test significant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>value numdf dendf 
  238     5    11 </code></pre>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb47" data-code-line-numbers="false"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lm_no_x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span><span class="va">x3</span>, data <span class="op">=</span> <span class="va">manpower</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_no_x3</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 2161.962    967.871     2.2  4.5e-02
x1            34.284      4.897     7.0  1.4e-05
x2             0.057      0.021     2.8  1.7e-02
x4            -6.600      5.311    -1.2  2.4e-01
x5          -440.297    183.696    -2.4  3.4e-02</code></pre>
</div>
</div>
</div>
</section><section id="methods-for-dealing-with-collinearity" class="slide level2"><h2>Methods for Dealing with Collinearity</h2>
<p><strong>Data collection</strong>: <span style="color:blue"> Collect more data to break up the collinearity </span> in the existing data</p>
<p><br></p>
<div class="fragment">
<p><strong>Model specification/An overdefined model</strong>: Respecify the model</p>
<ul>
<li>
<span style="color:blue"> <em>redefining</em> the regressors </span>: Use <span class="math inline">\(x = x_1+x_2\)</span> or <span class="math inline">\(x = x_1x_2\)</span>.
<ul>
<li>Avoid combining regressors in different units.</li>
</ul>
</li>
<li>
<span style="color:blue"> <em>eliminating</em> regressors </span>: remove <span class="math inline">\(x_1\)</span> or <span class="math inline">\(x_2\)</span>.
<ul>
<li>May damage the predictive power if the removed regressors have significant explanatory power. (Variable selection)</li>
<li>If we remove <span class="math inline">\(x_2\)</span>, we estimate the <em>marginal</em> relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x_1\)</span>, ignoring <span class="math inline">\(x_2\)</span>, rather than the <em>partial</em> relationship conditioning on <span class="math inline">\(x_2\)</span>.</li>
</ul>
</li>
</ul>
</div>
<div class="fragment">
<p><strong>Constraint on the model or in the population</strong>: Say goodbye to least-squares estimation.</p>
<ul>
<li><span style="color:blue"> Ridge Regression, Principal Component Regression, Bayesian Regression, etc </span></li>
</ul>
<!-- ## Unbiased vs. Biased Estimators {visibility="hidden"} --><!-- - The LSE ${\bf b}$ is *unbiased*, i.e., $E({\bf b}) = \bbeta$. --><!-- - LSE is a BLUE: has *minimum variance* among all *unbiased* linear estimators --><!-- - *No guarantee that this variance will be small.* --><!-- - When collinearity exists, $\var({\bf b})$ is largely inflated. --><!-- ```{r} --><!-- #| fig-asp: 0.35 --><!-- par(mar = c(2, 0, 2, 0), mgp = c(0.5, 0.5, 0), las = 1) --><!-- x <- seq(-3, 3, by = 0.1) --><!-- plot(x, dnorm(x), type = "l", lwd = 3, axes = F, xlab = "", ylab = "") --><!-- title(main = "Sampling distribution of LSE b") --><!-- axis(1, at = c(-3, 0.1, 3), labels = c("", expression(bold(beta) == E(b)), ""),  --><!--      tick = T, tck = -0.01) --><!-- segments(x0 = 0, y0 = 0, x1 = 0, y1 = dnorm(0), lty = 2) --><!-- text(2, dnorm(1), expression(paste("E(b) = ", bold(beta), " (unbiased)")), cex = 1.5) --><!-- text(2.5, dnorm(1.5), paste("Var(b) large"), cex = 1.5) --><!-- ``` --><!-- ::: notes --><!-- implying that confidence intervals on β would be wide and the point estimate ˆb is very unstable. --><!-- ::: --><!-- ## Biased Estimators {visibility="hidden"} --><!-- :::: {.columns} --><!-- ::: {.column width="45%"} --><!-- A good estimator is the one that *balances bias and variance well*, or the one that *minimizes the mean square error* $$\small \text{MSE}(\hat{\beta}) = E[(\hat{\beta} - \beta)^2] = \var(\hat{\beta}) + \text{bias}(\hat{\beta})^2$$ --><!-- - Biasedness and variance have a *trade-off* relationship! --><!-- - Find a **biased** estimator ${\bf \hat{b}}$ that has *smaller variance and MSE* than ${\bf b}$. --><!-- ::: --><!-- ::: {.column width="55%"} --><!-- ```{r} --><!-- #| out-width: 100% --><!-- par(mar = c(2, 0, 2, 0), mgp = c(0.5, 0.5, 0), las = 1) --><!-- x <- seq(-6, 6, by = 0.1) --><!-- plot(x, dnorm(x), type = "l", lwd = 3, axes = F, xlab = "", ylab = "", --><!--      xlim = c(-8, 8)) --><!-- title(main = list(expression(paste("Sampling distribution a biased estimator ", hat(b))), cex = 2)) --><!-- axis(1, at = c(-8, -1, 0, 8),  --><!--      labels = c("", expression(bold(beta)), expression(E(b)), ""),  --><!--      tick = T, tck = -0.01, cex.lab = 2) --><!-- segments(x0 = 0, y0 = 0, x1 = 0, y1 = dnorm(0), lty = 2) --><!-- segments(x0 = -1, y0 = 0, x1 = -1, y1 = dnorm(-1), lty = 2) --><!-- text(3.5, dnorm(1), expression(paste(E(hat(b)) != bold(beta), " (biased)")), cex = 2) --><!-- text(4, dnorm(1.5), expression(paste(Var(hat(b)), " small")), cex = 2) --><!-- ``` --><!-- ::: --><!-- :::: --><!-- ::: notes --><!-- <!-- .question[ --><p>–&gt; <!-- <!-- Can we obtain an estimator that has a smaller variance? --> –&gt; <!-- <!-- ] --> –&gt; <!-- ::: --></p>
<!-- ## Ridge Regression: Motivation  {visibility="hidden"} -->
<!-- - ${\bf \Sigma} = \begin{bmatrix} 1 & 0.992 \\ 0.992 & 1 \end{bmatrix}$ $\quad {\bf  \Sigma}^{-1} = \begin{bmatrix} 62.8 & -62.2 \\ -62.2 & 62.8 \end{bmatrix}$ -->
<!-- - $\lambda_1 = 1.992$ and $\lambda_2 = 0.008$ -->
<!-- . . . -->
<!-- - ${\bf \Sigma} = \begin{bmatrix} 1 & 0\\ 0 & 1 \end{bmatrix}$ $\quad {\bf \Sigma}^{-1} = \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}$ -->
<!-- - $\lambda_1 = 1$ and $\lambda_2 = 1$ -->
<!-- . . . -->
<!-- - IDEA: To make ${\bf \Sigma}$ behave more like the orthogonal case. But how? -->
<!-- . . . -->
<!-- - Use $({\bf X'X + \delta I})$ with a small $\delta >0$. -->
<!-- - The eigenvalues of $({\bf X'X + \delta I})$ are $\lambda_1+\delta$ and $\lambda_2 + \delta$. -->
<!-- - If $\delta = 0.1$, -->
<!-- $({\bf X'X + \delta I}) = \begin{bmatrix} 1.1 & 0.992 \\ 0.992 & 1.1 \end{bmatrix}$ and $({\bf X'X + \delta I})^{-1} = \begin{bmatrix} 4.87 & -4.39 \\ -4.39 & 4.87 \end{bmatrix}$ -->
<!-- ::: notes -->
<!-- - The diagonals *do not dominate* as in the orthogonal case whose matrix diagonals dominate and $\lambda_1 = \lambda_2 = 1$. -->
<!-- Adding $\delta$ to the main diagonal effectively replaces $\lambda$ by $\lambda+\delta$.  -->
<!-- ::: -->
<!-- ## Ridge Regression Estimator {visibility="hidden"} -->
<!-- - With a small $\delta >0$, the ridge estimator ${\bf b}_R$ is $${\bf b}_R = ({\bf X'X + \delta I})^{-1}{\bf X'y}$$ -->
<!-- - ${\bf b}_R$ is a *biased* estimator for $\bbeta$. -->
<!-- ::: notes -->
<!-- - $\sum_{i=1}^k \var\left( b_{Ri} \right) \le \sum_{i=1}^k \var\left( b_i \right)$ with equality when $\delta = 0$. -->
<!-- ::: -->
<!-- . . . -->
<!-- - As $\delta$ increases, -->
<!--   + $\sum_{i=1}^k \var\left( b_{Ri} \right)$ decreases -->
<!--   + Bias $E\left[ {\bf b}_R \right] - \bbeta$ increases -->

<!--   + $R^2$ decreases (it's OK as we care more about stable estimates and better prediction) -->
<!-- . . . -->
<!-- - Choose $\delta$ by the **ridge trace** that is a plot of $\{ b_{Ri} \}_{i=1}^k$ vs. $\delta$. -->

<!--   + Select a small value of $\delta$ at which the ridge estimates ${\bf b}_R$ are stable. -->
<!-- ::: notes -->
<!-- - Cross Validation -->
<!-- - The ridge estimator ${\bf b}_R$ is $${\bf b}_R = ({\bf X'X + \delta I})^{-1}{\bf X'y}$$ -->
<!-- - ${\bf b}_R$ is a *biased* estimator of $\bsbeta$: -->
<!-- $$E\left[ {\bf b}_R \right] = E\left[({\bf X'X + \delta I})^{-1}{\bf X'y} \right]  = E\left[({\bf X'X + \delta I})^{-1}({\bf X'X}){\bf b}\right] = {\bf Z_{\delta}}\bsbeta$$ -->
<!-- - The covariance matrix of ${\bf b}_R$ is -->
<!-- $$\var\left({\bf b}_R \right) = \sigma^2 ({\bf X'X + \delta I})^{-1}{\bf X'X }({\bf X'X + \delta I})^{-1}$$ -->
<!-- - For LSE, $\sum_{i=1}^k \var\left( b_i \right) = \sigma^2\sum_{i=1}^k\frac{1}{\lambda_i}$ -->
<!-- - For ridge estimator,  $\sum_{i=1}^k \var\left( b_{Ri} \right) = \sigma^2\sum_{i=1}^k\frac{\lambda_i}{(\lambda_i+\delta)^2}$ -->
<!-- - $\sum_{i=1}^k \var\left( b_{Ri} \right) \le \sum_{i=1}^k \var\left( b_i \right)$ with equality when $\delta = 0$. -->
<!-- - As $\delta$ increases, $\sum_{i=1}^k \var\left( b_{Ri} \right)$ decreases. -->
<!-- ::: -->
<!-- ## [R Lab]{.pink} Hospital Manpower - Ridge Regression {visibility="hidden"} -->
<!-- :::: {.columns} -->
<!-- ::: {.column width="40%"} -->
<!-- ::: midi -->
<!-- ```{r} -->
<!-- #| echo: true -->
<!-- #| eval: false -->
<!-- #| code-line-numbers: false -->
<!-- #| class-source: my_class800 -->
<!-- manpower_scale <- apply(manpower, 2, scale) -->
<!-- df <- as.data.frame(manpower_scale) -->
<!-- delta <- seq(0, 0.5, by = 0.01) -->
<!-- ridge_fit <- MASS::lm.ridge( -->
<!--   y ~ . -1, data = df, lambda = delta) -->
<!-- matplot(coef(ridge_fit), type = "l", -->
<!--         xlab = "delta", ylab = "Coef",  -->
<!--         main = "Ridge Trace") -->
<!-- abline(v = which(delta == 0.07),  -->
<!--        col = "orange", lty = 2) -->
<!-- ``` -->
<!-- ::: -->
<!-- ::: -->
<!-- ::: {.column width="60%"} -->
<!-- ```{r} -->
<!-- #| out-width: 100% -->
<!-- library(MASS) -->
<!-- # manpower_scale <- apply(manpower, 2,  -->
<!-- #                         unit_length_scale) -->
<!-- manpower_scale <- apply(manpower, 2, scale) -->
<!-- delta <- seq(0, 0.5, by = 0.01) -->
<!-- ridge_fit <- lm.ridge(y ~ . -1,  -->
<!--                       data = as.data.frame(manpower_scale),  -->
<!--                       lambda = delta) -->
<!-- par(mar = c(3, 3.5, 2, 0), mgp = c(2, 0.5, 0), las = 1) -->
<!-- matplot(coef(ridge_fit), type = "l", xlab = "delta", axes = F, cex.lab = 1.5, -->
<!--         ylab = "Coefficients", main = "Ridge Trace", lwd = 2.5, cex.main = 2) -->
<!-- axis(2, at = seq(-0.5, 1.5, by = 0.5)) -->
<!-- axis(1, at = c(0, 10, 20, 30, 40, 50), labels = delta[c(0, 10, 20, 30, 40, 50)+1]) -->
<!-- text(jitter(rep(15, 5), factor = 3), jitter(coef(ridge_fit)[15, ]), colnames(manpower_scale)[-1], cex = 1.5) -->
<!-- abline(v = which(delta == 0.07), col = "orange", lty = 2) -->
<!-- ``` -->
<!-- ::: -->
<!-- :::: -->
<!-- ::: notes -->
<!-- ```{r, eval=FALSE} -->
<!-- # use GCV to select the best delta -->
<!-- plot(ridge_fit$lambda, ridge_fit$GCV, type = "l", col = "darkorange",  -->
<!--      ylab = "GCV", xlab = "delta", lwd = 3) -->
<!-- title("Hospital Manpower Data: GCV") -->
<!-- ridge_fit$lambda[which.min(ridge_fit$GCV)] -->
<!-- ``` -->
<!-- ::: -->
<!-- ## [R Lab]{.pink} Hospital Manpower - Ridge Regression {visibility="hidden"} -->
<!-- ```{r} -->
<!-- #| out-width: 78% -->
<!-- manpower_scale <- as.data.frame(manpower_scale) -->
<!-- lm_full_scale <- lm(y ~ ., data = manpower_scale) -->
<!-- par(mar = c(3, 4, 0, 0), mgp = c(2, 0.5, 0)) -->
<!-- confidenceEllipse(lm_full_scale, which.coef = c(5, 6), col="black", -->
<!--                   fill=TRUE, -->
<!--                   center.cex=1, -->
<!--                   levels=c(0.8, 0.95), fill.alpha=0.1, -->
<!--                   xlab=expression(beta[4]),  -->
<!--                   ylab=expression(beta[5]),  -->
<!--                   las=1, segments=1000, cex.lab = 2) -->
<!-- abline(h = 0, v = 0) -->
<!-- points(0, 0, pch = 15, cex = 1, col = 2) -->
<!-- X_stX_s <- t(X_s) %*% X_s -->
<!-- A <- X_stX_s + diag(0.07, 5) -->
<!-- Ainv <- solve(A) -->
<!-- var_ridge <- summary(lm_full_scale)$sigma^2 * Ainv %*% X_stX_s %*% Ainv / (nrow(manpower) - 1) -->
<!-- # center <- c(0.10711510, 0.11790894) -->
<!-- # center <- c(-0.007907946, -0.020534287) -->
<!-- center <- c(-0.01925995, -0.02575226) -->
<!-- ellipse(center, shape = var_ridge[c(4, 5), c(4, 5)], center.cex=1, -->
<!--         radius = sqrt(qchisq(c(0.95), df = 2)), fill=TRUE, fill.alpha=0.1) -->
<!-- ellipse(center, shape = var_ridge[c(4, 5), c(4, 5)], center.cex=1, -->
<!--         radius = sqrt(qchisq(c(0.8), df = 2)), fill=TRUE, fill.alpha=0.1) -->
<!-- # ellipse(center, shape = var_ridge[c(1, 3), c(1, 3)], center.cex=1, -->
<!-- #         radius = sqrt(qchisq(c(0.95), df = 2)), fill=TRUE, fill.alpha=0.1) -->
<!-- # ellipse(center, shape = var_ridge[c(1, 3), c(1, 3)], center.cex=1, -->
<!-- #         radius = sqrt(qchisq(c(0.8), df = 2)), fill=TRUE, fill.alpha=0.1) -->
<!-- # confidenceEllipse(ridge_fit, which.coef = c(2, 4), col="black", -->
<!-- #                   fill=TRUE,  -->
<!-- #                   center.cex=1, -->
<!-- #                   levels=c(0.8, 0.95), fill.alpha=0.1, -->
<!-- #                   xlab=expression(beta[1]),  -->
<!-- #                   ylab=expression(beta[3]),  -->
<!-- #                   las=1, segments=1000) -->
<!-- # abline(h = 0, v = 0) -->
<!-- # points(0, 0, pch = 15, cex = 1, col = 2) -->
<!-- ``` -->

<p><img src="https://upload.wikimedia.org/wikipedia/commons/e/e8/Marquette_Golden_Eagles_logo.svg" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://math4780-f23.github.io/website/">math4780-f23.github.io/website</a></p>
</div>
</div>
</section></section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="../site_libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="../site_libs/revealjs/plugin/multiplex/socket.io.js"></script><script src="../site_libs/revealjs/plugin/multiplex/multiplex.js"></script><script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script><script src="../site_libs/revealjs/plugin/notes/notes.js"></script><script src="../site_libs/revealjs/plugin/search/search.js"></script><script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script><script src="../site_libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'multiplex': {"secret":null,"id":"8749aa1f062ce946","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1800,

        height: 1000,

        // Factor of the display size that should remain empty around the content
        margin: 5.0e-2,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>